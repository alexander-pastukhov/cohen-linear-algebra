<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Solutions for code challenges | R-version of the code for “Linear Algebra: Theory, Intuition, Code” by Mike X Cohen</title>
  <meta name="description" content="R-version of the code for Linear Algebra: Theory, Intuition, Code by Mike X Cohen" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Solutions for code challenges | R-version of the code for “Linear Algebra: Theory, Intuition, Code” by Mike X Cohen" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="R-version of the code for Linear Algebra: Theory, Intuition, Code by Mike X Cohen" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Solutions for code challenges | R-version of the code for “Linear Algebra: Theory, Intuition, Code” by Mike X Cohen" />
  
  <meta name="twitter:description" content="R-version of the code for Linear Algebra: Theory, Intuition, Code by Mike X Cohen" />
  

<meta name="author" content="Alexander (Sasha) Pastukhov" />


<meta name="date" content="2021-03-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="code.html"/>
<link rel="next" href="function-references.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R-code for Linear Algebra by Mike X Cohen</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#libraries-the-code-relies-upon"><i class="fa fa-check"></i>Libraries the code relies upon</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html"><i class="fa fa-check"></i>Code</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-2"><i class="fa fa-check"></i>Chapter 2</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-2.12.2"><i class="fa fa-check"></i>Code block 2.1/2.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-2.32.4"><i class="fa fa-check"></i>Code block 2.3/2.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-2.52.6"><i class="fa fa-check"></i>Code block 2.5/2.6</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-2.72.8"><i class="fa fa-check"></i>Code block 2.7/2.8</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-2.92.10"><i class="fa fa-check"></i>Code block 2.9/2.10</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-3"><i class="fa fa-check"></i>Chapter 3</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-3.13.2"><i class="fa fa-check"></i>Code block 3.1/3.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-3.33.4"><i class="fa fa-check"></i>Code block 3.3/3.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-3.53.6"><i class="fa fa-check"></i>Code block 3.5/3.6</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-3.73.8"><i class="fa fa-check"></i>Code block 3.7/3.8</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-3.93.10"><i class="fa fa-check"></i>Code block 3.9/3.10</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-5"><i class="fa fa-check"></i>Chapter 5</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.15.2"><i class="fa fa-check"></i>Code block 5.1/5.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.35.4"><i class="fa fa-check"></i>Code block 5.3/5.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.55.6"><i class="fa fa-check"></i>Code block 5.5/5.6</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.75.8"><i class="fa fa-check"></i>Code block 5.7/5.8</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.95.10"><i class="fa fa-check"></i>Code block 5.9/5.10</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.115.12"><i class="fa fa-check"></i>Code block 5.11/5.12</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.135.14"><i class="fa fa-check"></i>Code block 5.13/5.14</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.155.16"><i class="fa fa-check"></i>Code block 5.15/5.16</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-6"><i class="fa fa-check"></i>Chapter 6</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-6.16.2"><i class="fa fa-check"></i>Code block 6.1/6.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-6.36.4"><i class="fa fa-check"></i>Code block 6.3/6.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-6.56.6"><i class="fa fa-check"></i>Code block 6.5/6.6</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-6.76.8"><i class="fa fa-check"></i>Code block 6.7/6.8</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-6.96.10"><i class="fa fa-check"></i>Code block 6.9/6.10</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-6.116.12"><i class="fa fa-check"></i>Code block 6.11/6.12</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-7"><i class="fa fa-check"></i>Chapter 7</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-7.17.2"><i class="fa fa-check"></i>Code block 7.1/7.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-7.37.4"><i class="fa fa-check"></i>Code block 7.3/7.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-7.57.6"><i class="fa fa-check"></i>Code block 7.5/7.6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-8"><i class="fa fa-check"></i>Chapter 8</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-8.18.2"><i class="fa fa-check"></i>Code block 8.1/8.2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-9"><i class="fa fa-check"></i>Chapter 9</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-9.19.2"><i class="fa fa-check"></i>Code block 9.1/9.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-9.39.4"><i class="fa fa-check"></i>Code block 9.3/9.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-9.59.6"><i class="fa fa-check"></i>Code block 9.5/9.6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-10"><i class="fa fa-check"></i>Chapter 10</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-10.110.2"><i class="fa fa-check"></i>Code block 10.1/10.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-10.310.4"><i class="fa fa-check"></i>Code block 10.3/10.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-11"><i class="fa fa-check"></i>Chapter 11</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-11.111.2"><i class="fa fa-check"></i>Code block 11.1/11.2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-12"><i class="fa fa-check"></i>Chapter 12</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-12.112.2"><i class="fa fa-check"></i>Code block 12.1/12.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-12.312.4"><i class="fa fa-check"></i>Code block 12.3/12.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-12.512.6"><i class="fa fa-check"></i>Code block 12.5/12.6</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-12.712.8"><i class="fa fa-check"></i>Code block 12.7/12.8</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-13"><i class="fa fa-check"></i>Chapter 13</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-13.113.2"><i class="fa fa-check"></i>Code block 13.1/13.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-13.313.4"><i class="fa fa-check"></i>Code block 13.3/13.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-15"><i class="fa fa-check"></i>Chapter 15</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-15.115.2"><i class="fa fa-check"></i>Code block 15.1/15.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-15.315.4"><i class="fa fa-check"></i>Code block 15.3/15.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-16"><i class="fa fa-check"></i>Chapter 16</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-16.116.2"><i class="fa fa-check"></i>Code block 16.1/16.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-16.316.4"><i class="fa fa-check"></i>Code block 16.3/16.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-17"><i class="fa fa-check"></i>Chapter 17</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-17.117.2"><i class="fa fa-check"></i>Code block 17.1/17.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html"><i class="fa fa-check"></i>Solutions for code challenges</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-2-1"><i class="fa fa-check"></i>Chapter 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-3-1"><i class="fa fa-check"></i>Chapter 3</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-5-1"><i class="fa fa-check"></i>Chapter 5</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-1"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3-1"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-6-1"><i class="fa fa-check"></i>Chapter 6</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-2"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3-2"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-7-1"><i class="fa fa-check"></i>Chapter 7</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-3"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-3"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-8-1"><i class="fa fa-check"></i>Chapter 8</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-4"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-4"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-9-1"><i class="fa fa-check"></i>Chapter 9</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-5"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-5"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-10-1"><i class="fa fa-check"></i>Chapter 10</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-6"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-6"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-11-1"><i class="fa fa-check"></i>Chapter 11</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-7"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-7"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-12-1"><i class="fa fa-check"></i>Chapter 12</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-8"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-8"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-13-1"><i class="fa fa-check"></i>Chapter 13</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-9"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-14"><i class="fa fa-check"></i>Chapter 14</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-4-1"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-5"><i class="fa fa-check"></i>Exercise 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-15-1"><i class="fa fa-check"></i>Chapter 15</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-9"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-10"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3-4"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-16-1"><i class="fa fa-check"></i>Chapter 16</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-10"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-11"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3-5"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-4-2"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-5-1"><i class="fa fa-check"></i>Exercise 5</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-6"><i class="fa fa-check"></i>Exercise 6</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-7"><i class="fa fa-check"></i>Exercise 7</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-8"><i class="fa fa-check"></i>Exercise 8</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-9"><i class="fa fa-check"></i>Exercise 9</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-10"><i class="fa fa-check"></i>Exercise 10</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-12"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-18"><i class="fa fa-check"></i>Chapter 18</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-11"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-19"><i class="fa fa-check"></i>Chapter 19</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-12"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-13"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3-6"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html"><i class="fa fa-check"></i>Function references</a>
<ul>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#c"><i class="fa fa-check"></i>C</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#d"><i class="fa fa-check"></i>D</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#e"><i class="fa fa-check"></i>E</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#g"><i class="fa fa-check"></i>G</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#h"><i class="fa fa-check"></i>H</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#i"><i class="fa fa-check"></i>I</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#l"><i class="fa fa-check"></i>L</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#m"><i class="fa fa-check"></i>M</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#n"><i class="fa fa-check"></i>N</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#o"><i class="fa fa-check"></i>O</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#p"><i class="fa fa-check"></i>P</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#q"><i class="fa fa-check"></i>Q</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#s"><i class="fa fa-check"></i>S</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#t"><i class="fa fa-check"></i>T</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#u"><i class="fa fa-check"></i>U</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#v"><i class="fa fa-check"></i>V</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-version of the code for “Linear Algebra: Theory, Intuition, Code” by <em>Mike X Cohen</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="solutions-for-code-challenges" class="section level1 unnumbered" number="">
<h1>Solutions for code challenges</h1>
<div id="chapter-2-1" class="section level2 unnumbered" number="">
<h2>Chapter 2</h2>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="solutions-for-code-challenges.html#cb74-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb74-2"><a href="solutions-for-code-challenges.html#cb74-2"></a>v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb74-3"><a href="solutions-for-code-challenges.html#cb74-3"></a>s &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb74-4"><a href="solutions-for-code-challenges.html#cb74-4"></a></span>
<span id="cb74-5"><a href="solutions-for-code-challenges.html#cb74-5"></a>all_vectors &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">xend =</span> <span class="kw">c</span>(v[<span class="dv">1</span>], v[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>s),</span>
<span id="cb74-6"><a href="solutions-for-code-challenges.html#cb74-6"></a>                          <span class="dt">yend =</span> <span class="kw">c</span>(v[<span class="dv">2</span>], v[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>s),</span>
<span id="cb74-7"><a href="solutions-for-code-challenges.html#cb74-7"></a>                          <span class="dt">Vector =</span> <span class="kw">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;Scaled&quot;</span>, <span class="kw">length</span>(s))),</span>
<span id="cb74-8"><a href="solutions-for-code-challenges.html#cb74-8"></a>                          <span class="dt">x =</span> <span class="dv">0</span>,</span>
<span id="cb74-9"><a href="solutions-for-code-challenges.html#cb74-9"></a>                          <span class="dt">y =</span> <span class="dv">0</span>)</span>
<span id="cb74-10"><a href="solutions-for-code-challenges.html#cb74-10"></a></span>
<span id="cb74-11"><a href="solutions-for-code-challenges.html#cb74-11"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>all_vectors, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">xend=</span>xend, <span class="dt">yend=</span>yend, <span class="dt">color=</span>Vector)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb74-12"><a href="solutions-for-code-challenges.html#cb74-12"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">arrow=</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.03</span>, <span class="st">&quot;npc&quot;</span>))) <span class="op">+</span></span>
<span id="cb74-13"><a href="solutions-for-code-challenges.html#cb74-13"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb74-14"><a href="solutions-for-code-challenges.html#cb74-14"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb74-15"><a href="solutions-for-code-challenges.html#cb74-15"></a><span class="st">  </span><span class="kw">coord_equal</span>()</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e02-1-1.png" width="672" /></p>
</div>
<div id="chapter-3-1" class="section level2 unnumbered" number="">
<h2>Chapter 3</h2>
<div id="exercise-1" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="solutions-for-code-challenges.html#cb75-1"></a>v1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb75-2"><a href="solutions-for-code-challenges.html#cb75-2"></a>v2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb75-3"><a href="solutions-for-code-challenges.html#cb75-3"></a>v3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>)</span>
<span id="cb75-4"><a href="solutions-for-code-challenges.html#cb75-4"></a>w &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb75-5"><a href="solutions-for-code-challenges.html#cb75-5"></a>result &lt;-<span class="st"> </span>v1 <span class="op">*</span><span class="st"> </span>w[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>v2 <span class="op">*</span><span class="st"> </span>w[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>v3<span class="op">*</span><span class="st"> </span>w[<span class="dv">3</span>]</span></code></pre></div>
</div>
<div id="exercise-2" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="solutions-for-code-challenges.html#cb76-1"></a>v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">-5</span>, <span class="dv">8</span>, <span class="dv">3</span>)</span>
<span id="cb76-2"><a href="solutions-for-code-challenges.html#cb76-2"></a>o &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(v))</span>
<span id="cb76-3"><a href="solutions-for-code-challenges.html#cb76-3"></a>ave &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">dot</span>(v, o) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(v)</span></code></pre></div>
</div>
<div id="exercise-3" class="section level3 unnumbered" number="">
<h3>Exercise 3</h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="solutions-for-code-challenges.html#cb77-1"></a>v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">-5</span>, <span class="dv">8</span>, <span class="dv">3</span>)</span>
<span id="cb77-2"><a href="solutions-for-code-challenges.html#cb77-2"></a>w &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="kw">length</span>(v))</span>
<span id="cb77-3"><a href="solutions-for-code-challenges.html#cb77-3"></a>wAve &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">dot</span>(v, w <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(w))</span></code></pre></div>
</div>
</div>
<div id="chapter-5-1" class="section level2 unnumbered" number="">
<h2>Chapter 5</h2>
<div id="exercise-1-1" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="solutions-for-code-challenges.html#cb78-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb78-2"><a href="solutions-for-code-challenges.html#cb78-2"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb78-3"><a href="solutions-for-code-challenges.html#cb78-3"></a>C &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb78-4"><a href="solutions-for-code-challenges.html#cb78-4"></a><span class="cf">for</span>(coli <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){</span>
<span id="cb78-5"><a href="solutions-for-code-challenges.html#cb78-5"></a>  <span class="cf">for</span>(colj <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){</span>
<span id="cb78-6"><a href="solutions-for-code-challenges.html#cb78-6"></a>    C[coli, colj] &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">dot</span>(A[, coli], B[, colj])</span>
<span id="cb78-7"><a href="solutions-for-code-challenges.html#cb78-7"></a>  }</span>
<span id="cb78-8"><a href="solutions-for-code-challenges.html#cb78-8"></a>}</span></code></pre></div>
</div>
<div id="exercise-2-1" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="solutions-for-code-challenges.html#cb79-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb79-2"><a href="solutions-for-code-challenges.html#cb79-2"></a>Al &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">tril</span>(A)</span>
<span id="cb79-3"><a href="solutions-for-code-challenges.html#cb79-3"></a>S &lt;-<span class="st"> </span>Al <span class="op">+</span><span class="st"> </span><span class="kw">t</span>(Al)</span></code></pre></div>
</div>
<div id="exercise-3-1" class="section level3 unnumbered" number="">
<h3>Exercise 3</h3>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="solutions-for-code-challenges.html#cb80-1"></a>D &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">8</span>)</span>
<span id="cb80-2"><a href="solutions-for-code-challenges.html#cb80-2"></a><span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">min</span>(<span class="kw">dim</span>(D))){</span>
<span id="cb80-3"><a href="solutions-for-code-challenges.html#cb80-3"></a>  D[d, d] &lt;-<span class="st"> </span>d</span>
<span id="cb80-4"><a href="solutions-for-code-challenges.html#cb80-4"></a>}</span>
<span id="cb80-5"><a href="solutions-for-code-challenges.html#cb80-5"></a></span>
<span id="cb80-6"><a href="solutions-for-code-challenges.html#cb80-6"></a><span class="co"># or</span></span>
<span id="cb80-7"><a href="solutions-for-code-challenges.html#cb80-7"></a>D &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">8</span>)</span></code></pre></div>
</div>
</div>
<div id="chapter-6-1" class="section level2 unnumbered" number="">
<h2>Chapter 6</h2>
<div id="exercise-1-2" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="solutions-for-code-challenges.html#cb81-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">2</span><span class="op">*</span><span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb81-2"><a href="solutions-for-code-challenges.html#cb81-2"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb81-3"><a href="solutions-for-code-challenges.html#cb81-3"></a>C1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb81-4"><a href="solutions-for-code-challenges.html#cb81-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb81-5"><a href="solutions-for-code-challenges.html#cb81-5"></a>  C1 &lt;-<span class="st"> </span>C1 <span class="op">+</span><span class="st"> </span><span class="kw">outer</span>(A[, i], B[i, ])</span>
<span id="cb81-6"><a href="solutions-for-code-challenges.html#cb81-6"></a>}</span>
<span id="cb81-7"><a href="solutions-for-code-challenges.html#cb81-7"></a>C1 <span class="op">-</span><span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>B</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    0    0    0
## [2,]    0    0    0</code></pre>
</div>
<div id="exercise-2-2" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="solutions-for-code-challenges.html#cb83-1"></a>D &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb83-2"><a href="solutions-for-code-challenges.html#cb83-2"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb83-3"><a href="solutions-for-code-challenges.html#cb83-3"></a>C1 &lt;-<span class="st"> </span>D <span class="op">*</span><span class="st"> </span>A</span>
<span id="cb83-4"><a href="solutions-for-code-challenges.html#cb83-4"></a>C2 &lt;-<span class="st"> </span>D <span class="op">%*%</span><span class="st"> </span>A</span>
<span id="cb83-5"><a href="solutions-for-code-challenges.html#cb83-5"></a><span class="kw">print</span>(<span class="kw">diag</span>(C1))</span></code></pre></div>
<pre><code>## [1] 0.4407820 0.4891542 1.0255423 0.1605507</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="solutions-for-code-challenges.html#cb85-1"></a><span class="kw">print</span>(<span class="kw">diag</span>(C2))</span></code></pre></div>
<pre><code>## [1] 0.4407820 0.4891542 1.0255423 0.1605507</code></pre>
</div>
<div id="exercise-3-2" class="section level3 unnumbered" number="">
<h3>Exercise 3</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="solutions-for-code-challenges.html#cb87-1"></a>A &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">runif</span>(<span class="dv">3</span>))</span>
<span id="cb87-2"><a href="solutions-for-code-challenges.html#cb87-2"></a>C1 &lt;-<span class="st"> </span>(<span class="kw">t</span>(A) <span class="op">+</span><span class="st"> </span>A) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb87-3"><a href="solutions-for-code-challenges.html#cb87-3"></a>C2 &lt;-<span class="st"> </span><span class="kw">t</span>(A) <span class="op">%*%</span><span class="st"> </span>A</span>
<span id="cb87-4"><a href="solutions-for-code-challenges.html#cb87-4"></a>C1 <span class="op">-</span><span class="st"> </span><span class="kw">sqrt</span>(C2)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    0    0    0
## [2,]    0    0    0
## [3,]    0    0    0</code></pre>
</div>
<div id="exercise-4" class="section level3 unnumbered" number="">
<h3>Exercise 4</h3>
<p>Note that <code>norm()</code> requires a matrix as an input, therefore, we convert an atomic vector to a matrix for the norm computation.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="solutions-for-code-challenges.html#cb89-1"></a>m &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb89-2"><a href="solutions-for-code-challenges.html#cb89-2"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span>m<span class="op">*</span>m), <span class="dt">nrow=</span>m, <span class="dt">ncol=</span>m)</span>
<span id="cb89-3"><a href="solutions-for-code-challenges.html#cb89-3"></a>v &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n=</span>m)</span>
<span id="cb89-4"><a href="solutions-for-code-challenges.html#cb89-4"></a>LHS &lt;-<span class="st"> </span><span class="kw">norm</span>(A <span class="op">%*%</span><span class="st"> </span>v, <span class="dt">type =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb89-5"><a href="solutions-for-code-challenges.html#cb89-5"></a>RHS &lt;-<span class="st"> </span><span class="kw">norm</span>(A, <span class="dt">type =</span> <span class="st">&quot;F&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="kw">norm</span>(<span class="kw">matrix</span>(v), <span class="dt">type=</span><span class="st">&quot;F&quot;</span>)</span>
<span id="cb89-6"><a href="solutions-for-code-challenges.html#cb89-6"></a>RHS <span class="op">-</span><span class="st"> </span>LHS <span class="co"># should always be positive</span></span></code></pre></div>
<pre><code>## [1] 0.3911112</code></pre>
</div>
</div>
<div id="chapter-7-1" class="section level2 unnumbered" number="">
<h2>Chapter 7</h2>
<div id="exercise-1-3" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="solutions-for-code-challenges.html#cb91-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">9</span><span class="op">*</span><span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">9</span>, <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb91-2"><a href="solutions-for-code-challenges.html#cb91-2"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">2</span><span class="op">*</span><span class="dv">16</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">16</span>)</span>
<span id="cb91-3"><a href="solutions-for-code-challenges.html#cb91-3"></a>C &lt;-<span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>B</span></code></pre></div>
</div>
<div id="exercise-2-3" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="solutions-for-code-challenges.html#cb92-1"></a>Z &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb92-2"><a href="solutions-for-code-challenges.html#cb92-2"></a>N &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>), <span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb92-3"><a href="solutions-for-code-challenges.html#cb92-3"></a>ZN &lt;-<span class="st">  </span>Z <span class="op">+</span><span class="st"> </span>N <span class="op">*</span><span class="st"> </span>.Machine<span class="op">$</span>double.eps <span class="op">*</span><span class="st"> </span><span class="fl">1e-307</span></span>
<span id="cb92-4"><a href="solutions-for-code-challenges.html#cb92-4"></a><span class="kw">print</span>(pracma<span class="op">::</span><span class="kw">Rank</span>(Z))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="solutions-for-code-challenges.html#cb94-1"></a><span class="kw">print</span>(pracma<span class="op">::</span><span class="kw">Rank</span>(ZN))</span></code></pre></div>
<pre><code>## Warning in pracma::Rank(ZN): Rank calculation may be problematic.</code></pre>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="solutions-for-code-challenges.html#cb97-1"></a><span class="kw">print</span>(<span class="kw">norm</span>(ZN, <span class="dt">type =</span> <span class="st">&quot;F&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 5.434722e-323</code></pre>
</div>
</div>
<div id="chapter-8-1" class="section level2 unnumbered" number="">
<h2>Chapter 8</h2>
<div id="exercise-1-4" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="solutions-for-code-challenges.html#cb99-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">3</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb99-2"><a href="solutions-for-code-challenges.html#cb99-2"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">3</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb99-3"><a href="solutions-for-code-challenges.html#cb99-3"></a>n &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">nullspace</span>(A)</span>
<span id="cb99-4"><a href="solutions-for-code-challenges.html#cb99-4"></a><span class="kw">print</span>(B <span class="op">%*%</span><span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>n) <span class="co"># zeros vector</span></span></code></pre></div>
<pre><code>##               [,1]
## [1,]  5.551115e-17
## [2,] -5.551115e-17
## [3,] -1.665335e-16
## [4,]  1.110223e-16</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="solutions-for-code-challenges.html#cb101-1"></a><span class="kw">print</span>(A <span class="op">%*%</span><span class="st"> </span>B <span class="op">%*%</span><span class="st"> </span>n) <span class="co"># not zeros vector</span></span></code></pre></div>
<pre><code>##            [,1]
## [1,] 0.22722870
## [2,] 0.21246335
## [3,] 0.05179135
## [4,] 0.03917362</code></pre>
</div>
<div id="exercise-2-4" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="solutions-for-code-challenges.html#cb103-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">16</span><span class="op">*</span><span class="dv">9</span>), <span class="dt">nrow=</span><span class="dv">16</span>, <span class="dt">ncol=</span><span class="dv">9</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">9</span><span class="op">*</span><span class="dv">11</span>), <span class="dt">nrow=</span><span class="dv">9</span>, <span class="dt">ncol=</span><span class="dv">11</span>)</span>
<span id="cb103-2"><a href="solutions-for-code-challenges.html#cb103-2"></a>rn &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">nullspace</span>(A)</span>
<span id="cb103-3"><a href="solutions-for-code-challenges.html#cb103-3"></a>ln &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">nullspace</span>(<span class="kw">t</span>(A))</span>
<span id="cb103-4"><a href="solutions-for-code-challenges.html#cb103-4"></a>r &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">Rank</span>(A)</span>
<span id="cb103-5"><a href="solutions-for-code-challenges.html#cb103-5"></a><span class="kw">print</span>(<span class="kw">ncol</span>(rn) <span class="op">+</span><span class="st"> </span>r)</span></code></pre></div>
<pre><code>## [1] 11</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="solutions-for-code-challenges.html#cb105-1"></a><span class="kw">print</span>(<span class="kw">ncol</span>(ln) <span class="op">+</span><span class="st"> </span>r)</span></code></pre></div>
<pre><code>## [1] 16</code></pre>
</div>
</div>
<div id="chapter-9-1" class="section level2 unnumbered" number="">
<h2>Chapter 9</h2>
<div id="exercise-1-5" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<p>Base R does not implement Hermitian transpose directly and you are advised to compute it via <code>Conj(t(A))</code>, see <em>Notes</em> for [t()](<a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/t.html" class="uri">https://stat.ethz.ch/R-manual/R-devel/library/base/html/t.html</a> function.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="solutions-for-code-challenges.html#cb107-1"></a>U &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">+</span>1i, <span class="dv">1</span><span class="op">-</span>1i, <span class="dv">1</span><span class="op">-</span>1i, <span class="dv">1</span><span class="op">+</span>1i), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb107-2"><a href="solutions-for-code-challenges.html#cb107-2"></a><span class="kw">print</span>(U <span class="op">%*%</span><span class="st"> </span><span class="kw">Conj</span>(<span class="kw">t</span>(U))) <span class="co"># Hermitian</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,] 1+0i 0+0i
## [2,] 0+0i 1+0i</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="solutions-for-code-challenges.html#cb109-1"></a><span class="kw">print</span>(U <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(U)) <span class="co"># not Hermitian</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,] 0+0i 1+0i
## [2,] 1+0i 0+0i</code></pre>
</div>
<div id="exercise-2-5" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<p>In contrast to Matlab, a complex matrix
<a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/isSymmetric.html">isSymmetric()</a> only if it is Hermitian.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="solutions-for-code-challenges.html#cb111-1"></a>r &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb111-2"><a href="solutions-for-code-challenges.html#cb111-2"></a>im &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb111-3"><a href="solutions-for-code-challenges.html#cb111-3"></a>A &lt;-<span class="st"> </span>r <span class="op">+</span><span class="st"> </span>im <span class="op">*</span><span class="st"> </span>1i</span>
<span id="cb111-4"><a href="solutions-for-code-challenges.html#cb111-4"></a>A1 &lt;-<span class="st"> </span>A <span class="op">+</span><span class="st"> </span><span class="kw">Conj</span>(<span class="kw">t</span>(A))</span>
<span id="cb111-5"><a href="solutions-for-code-challenges.html#cb111-5"></a>A2 &lt;-<span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span><span class="kw">Conj</span>(<span class="kw">t</span>(A))</span>
<span id="cb111-6"><a href="solutions-for-code-challenges.html#cb111-6"></a><span class="kw">isSymmetric</span>(A1)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="solutions-for-code-challenges.html#cb113-1"></a><span class="kw">isSymmetric</span>(A2)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="chapter-10-1" class="section level2 unnumbered" number="">
<h2>Chapter 10</h2>
<div id="exercise-1-6" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="solutions-for-code-challenges.html#cb115-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">-3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">-1</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb115-2"><a href="solutions-for-code-challenges.html#cb115-2"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb115-3"><a href="solutions-for-code-challenges.html#cb115-3"></a>b &lt;-<span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>x</span></code></pre></div>
</div>
<div id="exercise-2-6" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="solutions-for-code-challenges.html#cb116-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">6</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">6</span>)</span>
<span id="cb116-2"><a href="solutions-for-code-challenges.html#cb116-2"></a>pracma<span class="op">::</span><span class="kw">rref</span>(A)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]       [,4]      [,5]       [,6]
## [1,]    1    0    0  0.4892414  1.882597  1.3067571
## [2,]    0    1    0 -0.5072360  1.562761  0.2554863
## [3,]    0    0    1  0.8116224 -1.923485 -0.2257580</code></pre>
</div>
</div>
<div id="chapter-11-1" class="section level2 unnumbered" number="">
<h2>Chapter 11</h2>
<div id="exercise-1-7" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="solutions-for-code-challenges.html#cb118-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">size=</span><span class="dv">4</span><span class="op">*</span><span class="dv">4</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb118-2"><a href="solutions-for-code-challenges.html#cb118-2"></a>b &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="op">-</span><span class="dv">10</span><span class="op">:-</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">1</span>)</span>
<span id="cb118-3"><a href="solutions-for-code-challenges.html#cb118-3"></a><span class="kw">print</span>(<span class="kw">det</span>(b <span class="op">*</span><span class="st"> </span>A))</span></code></pre></div>
<pre><code>## [1] 159375</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="solutions-for-code-challenges.html#cb120-1"></a><span class="kw">print</span>(b<span class="op">^</span><span class="kw">nrow</span>(A) <span class="op">*</span><span class="st"> </span><span class="kw">det</span>(A))</span></code></pre></div>
<pre><code>## [1] 159375</code></pre>
</div>
<div id="exercise-2-7" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="solutions-for-code-challenges.html#cb122-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb122-2"><a href="solutions-for-code-challenges.html#cb122-2"></a></span>
<span id="cb122-3"><a href="solutions-for-code-challenges.html#cb122-3"></a>ns &lt;-<span class="st"> </span><span class="dv">3</span><span class="op">:</span><span class="dv">30</span></span>
<span id="cb122-4"><a href="solutions-for-code-challenges.html#cb122-4"></a>iters &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb122-5"><a href="solutions-for-code-challenges.html#cb122-5"></a>dets &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="kw">length</span>(ns), <span class="dt">ncol =</span> iters)</span>
<span id="cb122-6"><a href="solutions-for-code-challenges.html#cb122-6"></a></span>
<span id="cb122-7"><a href="solutions-for-code-challenges.html#cb122-7"></a><span class="cf">for</span>(ni <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(ns)){</span>
<span id="cb122-8"><a href="solutions-for-code-challenges.html#cb122-8"></a>  <span class="cf">for</span>(it <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>iters){</span>
<span id="cb122-9"><a href="solutions-for-code-challenges.html#cb122-9"></a>    A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span>ns[ni]<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span>ns[ni], <span class="dt">ncol=</span>ns[ni]) <span class="co"># step 1</span></span>
<span id="cb122-10"><a href="solutions-for-code-challenges.html#cb122-10"></a>    A[, <span class="dv">1</span>] &lt;-<span class="st"> </span>A[, <span class="dv">2</span>]  <span class="co"># step 2  </span></span>
<span id="cb122-11"><a href="solutions-for-code-challenges.html#cb122-11"></a>    dets[ni, it] &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">det</span>(A)) <span class="co"># step 3</span></span>
<span id="cb122-12"><a href="solutions-for-code-challenges.html#cb122-12"></a>  }</span>
<span id="cb122-13"><a href="solutions-for-code-challenges.html#cb122-13"></a>}</span>
<span id="cb122-14"><a href="solutions-for-code-challenges.html#cb122-14"></a></span>
<span id="cb122-15"><a href="solutions-for-code-challenges.html#cb122-15"></a>dets_summary &lt;-<span class="st"> </span></span>
<span id="cb122-16"><a href="solutions-for-code-challenges.html#cb122-16"></a><span class="st">  </span><span class="kw">data.frame</span>(<span class="dt">MatrixSize =</span> ns,</span>
<span id="cb122-17"><a href="solutions-for-code-challenges.html#cb122-17"></a>             <span class="dt">LogDeterminant =</span> <span class="kw">log</span>(<span class="kw">apply</span>(dets, <span class="dt">MARGIN =</span> <span class="dv">1</span>, mean)))</span>
<span id="cb122-18"><a href="solutions-for-code-challenges.html#cb122-18"></a></span>
<span id="cb122-19"><a href="solutions-for-code-challenges.html#cb122-19"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>dets_summary, <span class="kw">aes</span>(<span class="dt">x=</span>MatrixSize, <span class="dt">y=</span>LogDeterminant)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb122-20"><a href="solutions-for-code-challenges.html#cb122-20"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb122-21"><a href="solutions-for-code-challenges.html#cb122-21"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb122-22"><a href="solutions-for-code-challenges.html#cb122-22"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Matrix size&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb122-23"><a href="solutions-for-code-challenges.html#cb122-23"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Log determinant&quot;</span>)</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e11-2-1.png" width="672" /></p>
</div>
</div>
<div id="chapter-12-1" class="section level2 unnumbered" number="">
<h2>Chapter 12</h2>
<div id="exercise-1-8" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="solutions-for-code-challenges.html#cb123-1"></a><span class="co"># create matrix</span></span>
<span id="cb123-2"><a href="solutions-for-code-challenges.html#cb123-2"></a>m &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb123-3"><a href="solutions-for-code-challenges.html#cb123-3"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(m<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span>m, <span class="dt">ncol=</span>m)</span>
<span id="cb123-4"><a href="solutions-for-code-challenges.html#cb123-4"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>m, <span class="dt">ncol=</span>m)</span>
<span id="cb123-5"><a href="solutions-for-code-challenges.html#cb123-5"></a>G &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>m, <span class="dt">ncol=</span>m)</span>
<span id="cb123-6"><a href="solutions-for-code-challenges.html#cb123-6"></a></span>
<span id="cb123-7"><a href="solutions-for-code-challenges.html#cb123-7"></a><span class="co"># compute minors matrix</span></span>
<span id="cb123-8"><a href="solutions-for-code-challenges.html#cb123-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb123-9"><a href="solutions-for-code-challenges.html#cb123-9"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb123-10"><a href="solutions-for-code-challenges.html#cb123-10"></a>    </span>
<span id="cb123-11"><a href="solutions-for-code-challenges.html#cb123-11"></a>    <span class="co">## select rows and cols</span></span>
<span id="cb123-12"><a href="solutions-for-code-challenges.html#cb123-12"></a>    <span class="co"># implementation matching the original</span></span>
<span id="cb123-13"><a href="solutions-for-code-challenges.html#cb123-13"></a>    rows &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">TRUE</span>, m)</span>
<span id="cb123-14"><a href="solutions-for-code-challenges.html#cb123-14"></a>    rows[i] &lt;-<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb123-15"><a href="solutions-for-code-challenges.html#cb123-15"></a>    cols &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">TRUE</span>, m)</span>
<span id="cb123-16"><a href="solutions-for-code-challenges.html#cb123-16"></a>    cols[j] &lt;-<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb123-17"><a href="solutions-for-code-challenges.html#cb123-17"></a>    M[i, j] &lt;-<span class="st"> </span><span class="kw">det</span>(A[rows, cols])</span>
<span id="cb123-18"><a href="solutions-for-code-challenges.html#cb123-18"></a>    </span>
<span id="cb123-19"><a href="solutions-for-code-challenges.html#cb123-19"></a>    <span class="co"># a simpler R-version using negative (excluding) indexing</span></span>
<span id="cb123-20"><a href="solutions-for-code-challenges.html#cb123-20"></a>    M[i, j] &lt;-<span class="st"> </span><span class="kw">det</span>(A[<span class="op">-</span>i, <span class="op">-</span>j])</span>
<span id="cb123-21"><a href="solutions-for-code-challenges.html#cb123-21"></a>    </span>
<span id="cb123-22"><a href="solutions-for-code-challenges.html#cb123-22"></a>    <span class="co"># compute G</span></span>
<span id="cb123-23"><a href="solutions-for-code-challenges.html#cb123-23"></a>    G[i, j] &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span>(i <span class="op">+</span><span class="st"> </span>j)</span>
<span id="cb123-24"><a href="solutions-for-code-challenges.html#cb123-24"></a>  }</span>
<span id="cb123-25"><a href="solutions-for-code-challenges.html#cb123-25"></a>}</span>
<span id="cb123-26"><a href="solutions-for-code-challenges.html#cb123-26"></a></span>
<span id="cb123-27"><a href="solutions-for-code-challenges.html#cb123-27"></a><span class="co"># compute C</span></span>
<span id="cb123-28"><a href="solutions-for-code-challenges.html#cb123-28"></a>C &lt;-<span class="st"> </span>M <span class="op">*</span><span class="st"> </span>G</span>
<span id="cb123-29"><a href="solutions-for-code-challenges.html#cb123-29"></a></span>
<span id="cb123-30"><a href="solutions-for-code-challenges.html#cb123-30"></a><span class="co"># compute A</span></span>
<span id="cb123-31"><a href="solutions-for-code-challenges.html#cb123-31"></a>Ainv &lt;-<span class="st"> </span><span class="kw">t</span>(C) <span class="op">/</span><span class="st"> </span><span class="kw">det</span>(A)</span>
<span id="cb123-32"><a href="solutions-for-code-challenges.html#cb123-32"></a>AinvI &lt;-<span class="st"> </span><span class="kw">solve</span>(A)</span>
<span id="cb123-33"><a href="solutions-for-code-challenges.html#cb123-33"></a><span class="kw">round</span>(AinvI <span class="op">-</span><span class="st"> </span>Ainv, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    0    0    0    0
## [2,]    0    0    0    0
## [3,]    0    0    0    0
## [4,]    0    0    0    0</code></pre>
</div>
<div id="exercise-2-8" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<p>I renamed <code>T</code> into <code>TM</code>, as <code>T</code> is a logical <code>TRUE</code> in R.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="solutions-for-code-challenges.html#cb125-1"></a><span class="co"># square matrix</span></span>
<span id="cb125-2"><a href="solutions-for-code-challenges.html#cb125-2"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">5</span><span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb125-3"><a href="solutions-for-code-challenges.html#cb125-3"></a>Ai &lt;-<span class="st"> </span><span class="kw">solve</span>(A)</span>
<span id="cb125-4"><a href="solutions-for-code-challenges.html#cb125-4"></a>Api &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">pinv</span>(A)</span>
<span id="cb125-5"><a href="solutions-for-code-challenges.html#cb125-5"></a><span class="kw">print</span>(<span class="kw">round</span>(Ai <span class="op">-</span><span class="st"> </span>Api))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    0    0    0    0    0
## [2,]    0    0    0    0    0
## [3,]    0    0    0    0    0
## [4,]    0    0    0    0    0
## [5,]    0    0    0    0    0</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="solutions-for-code-challenges.html#cb127-1"></a><span class="co"># tall matrix</span></span>
<span id="cb127-2"><a href="solutions-for-code-challenges.html#cb127-2"></a>TM &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">5</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb127-3"><a href="solutions-for-code-challenges.html#cb127-3"></a>TMl &lt;-<span class="st"> </span><span class="kw">solve</span>(<span class="kw">t</span>(TM) <span class="op">%*%</span><span class="st"> </span>TM) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(TM)</span>
<span id="cb127-4"><a href="solutions-for-code-challenges.html#cb127-4"></a>TMpi &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">pinv</span>(TM)</span>
<span id="cb127-5"><a href="solutions-for-code-challenges.html#cb127-5"></a><span class="kw">print</span>(<span class="kw">round</span>(TMl <span class="op">-</span><span class="st"> </span>TMpi))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    0    0    0    0    0
## [2,]    0    0    0    0    0
## [3,]    0    0    0    0    0</code></pre>
</div>
</div>
<div id="chapter-13-1" class="section level2 unnumbered" number="">
<h2>Chapter 13</h2>
<div id="exercise-2-9" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="solutions-for-code-challenges.html#cb129-1"></a>m &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb129-2"><a href="solutions-for-code-challenges.html#cb129-2"></a>n &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb129-3"><a href="solutions-for-code-challenges.html#cb129-3"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span>m<span class="op">*</span>n), <span class="dt">nrow=</span>m, <span class="dt">ncol=</span>n)</span>
<span id="cb129-4"><a href="solutions-for-code-challenges.html#cb129-4"></a>Q &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>m, <span class="dt">ncol=</span>n)</span>
<span id="cb129-5"><a href="solutions-for-code-challenges.html#cb129-5"></a></span>
<span id="cb129-6"><a href="solutions-for-code-challenges.html#cb129-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb129-7"><a href="solutions-for-code-challenges.html#cb129-7"></a>  Q[, i] &lt;-<span class="st"> </span>A[, i]</span>
<span id="cb129-8"><a href="solutions-for-code-challenges.html#cb129-8"></a>  </span>
<span id="cb129-9"><a href="solutions-for-code-challenges.html#cb129-9"></a>  <span class="co"># orthogonalize</span></span>
<span id="cb129-10"><a href="solutions-for-code-challenges.html#cb129-10"></a>  a &lt;-<span class="st"> </span>A[, i] <span class="co"># convenience</span></span>
<span id="cb129-11"><a href="solutions-for-code-challenges.html#cb129-11"></a>  <span class="cf">if</span> (i <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>){</span>
<span id="cb129-12"><a href="solutions-for-code-challenges.html#cb129-12"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(i<span class="dv">-1</span>)){</span>
<span id="cb129-13"><a href="solutions-for-code-challenges.html#cb129-13"></a>      q &lt;-<span class="st"> </span>Q[, j] <span class="co"># convenience</span></span>
<span id="cb129-14"><a href="solutions-for-code-challenges.html#cb129-14"></a>      Q[, i] &lt;-<span class="st"> </span>Q[, i] <span class="op">-</span><span class="st"> </span>pracma<span class="op">::</span><span class="kw">dot</span>(a, q) <span class="op">/</span><span class="st"> </span>pracma<span class="op">::</span><span class="kw">dot</span>(q, q) <span class="op">*</span><span class="st"> </span>q </span>
<span id="cb129-15"><a href="solutions-for-code-challenges.html#cb129-15"></a>    }</span>
<span id="cb129-16"><a href="solutions-for-code-challenges.html#cb129-16"></a>  }</span>
<span id="cb129-17"><a href="solutions-for-code-challenges.html#cb129-17"></a>  </span>
<span id="cb129-18"><a href="solutions-for-code-challenges.html#cb129-18"></a>  <span class="co"># normalize</span></span>
<span id="cb129-19"><a href="solutions-for-code-challenges.html#cb129-19"></a>  Q[, i] &lt;-<span class="st"> </span>Q[, i] <span class="op">/</span><span class="st"> </span><span class="kw">norm</span>(<span class="kw">matrix</span>(Q[, i]), <span class="dt">type=</span><span class="st">&quot;F&quot;</span>)</span>
<span id="cb129-20"><a href="solutions-for-code-challenges.html#cb129-20"></a>}</span>
<span id="cb129-21"><a href="solutions-for-code-challenges.html#cb129-21"></a></span>
<span id="cb129-22"><a href="solutions-for-code-challenges.html#cb129-22"></a>QR &lt;-<span class="st"> </span><span class="kw">qr</span>(A)</span>
<span id="cb129-23"><a href="solutions-for-code-challenges.html#cb129-23"></a>Q2 &lt;-<span class="st"> </span><span class="kw">qr.Q</span>(QR)</span></code></pre></div>
</div>
</div>
<div id="chapter-14" class="section level2 unnumbered" number="">
<h2>Chapter 14</h2>
<div id="exercise-3-3" class="section level3 unnumbered" number="">
<h3>Exercise 3</h3>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="solutions-for-code-challenges.html#cb130-1"></a><span class="co"># load the data into a table that we convert to a matrix</span></span>
<span id="cb130-2"><a href="solutions-for-code-challenges.html#cb130-2"></a>df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://sincxpress.com/widget_data.txt&quot;</span>, <span class="dt">header=</span><span class="ot">FALSE</span>)</span>
<span id="cb130-3"><a href="solutions-for-code-challenges.html#cb130-3"></a>data &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(df)</span>
<span id="cb130-4"><a href="solutions-for-code-challenges.html#cb130-4"></a></span>
<span id="cb130-5"><a href="solutions-for-code-challenges.html#cb130-5"></a><span class="co"># design matrix</span></span>
<span id="cb130-6"><a href="solutions-for-code-challenges.html#cb130-6"></a>X &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(data)), data[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</span>
<span id="cb130-7"><a href="solutions-for-code-challenges.html#cb130-7"></a><span class="kw">colnames</span>(X) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>)</span>
<span id="cb130-8"><a href="solutions-for-code-challenges.html#cb130-8"></a></span>
<span id="cb130-9"><a href="solutions-for-code-challenges.html#cb130-9"></a><span class="co"># outcome variable</span></span>
<span id="cb130-10"><a href="solutions-for-code-challenges.html#cb130-10"></a>y &lt;-<span class="st"> </span>data[, <span class="dv">3</span>]</span>
<span id="cb130-11"><a href="solutions-for-code-challenges.html#cb130-11"></a></span>
<span id="cb130-12"><a href="solutions-for-code-challenges.html#cb130-12"></a><span class="co"># beta coefficients[]</span></span>
<span id="cb130-13"><a href="solutions-for-code-challenges.html#cb130-13"></a>beta &lt;-<span class="st"> </span><span class="kw">lsfit</span>(X, y)<span class="op">$</span>coefficients[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>## Warning in lsfit(X, y): &#39;X&#39; matrix was collinear</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="solutions-for-code-challenges.html#cb132-1"></a><span class="co"># scaled coefficients (intercept not scaled)</span></span>
<span id="cb132-2"><a href="solutions-for-code-challenges.html#cb132-2"></a>betaScaled &lt;-<span class="st"> </span>beta <span class="op">/</span><span class="st"> </span><span class="kw">apply</span>(X, <span class="dt">MARGIN=</span><span class="dv">2</span>, <span class="dt">FUN=</span>sd)</span></code></pre></div>
</div>
<div id="exercise-4-1" class="section level3 unnumbered" number="">
<h3>Exercise 4</h3>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="solutions-for-code-challenges.html#cb133-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb133-2"><a href="solutions-for-code-challenges.html#cb133-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb133-3"><a href="solutions-for-code-challenges.html#cb133-3"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb133-4"><a href="solutions-for-code-challenges.html#cb133-4"></a></span>
<span id="cb133-5"><a href="solutions-for-code-challenges.html#cb133-5"></a>df_long &lt;-</span>
<span id="cb133-6"><a href="solutions-for-code-challenges.html#cb133-6"></a><span class="st">  </span>df <span class="op">%&gt;%</span></span>
<span id="cb133-7"><a href="solutions-for-code-challenges.html#cb133-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="st">&quot;Time of day&quot;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Age&quot;</span> =<span class="st"> </span><span class="dv">2</span>, <span class="st">&quot;Widgets purchased&quot;</span>=<span class="dv">3</span>) <span class="op">%&gt;%</span></span>
<span id="cb133-8"><a href="solutions-for-code-challenges.html#cb133-8"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;Time of day&quot;</span>, <span class="st">&quot;Age&quot;</span>), <span class="dt">names_to =</span> <span class="st">&quot;Variable name&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb133-9"><a href="solutions-for-code-challenges.html#cb133-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Variable name</span><span class="st">`</span> =<span class="st"> </span><span class="kw">factor</span>(<span class="st">`</span><span class="dt">Variable name</span><span class="st">`</span>, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;Time of day&quot;</span>, <span class="st">&quot;Age&quot;</span>)))</span>
<span id="cb133-10"><a href="solutions-for-code-challenges.html#cb133-10"></a></span>
<span id="cb133-11"><a href="solutions-for-code-challenges.html#cb133-11"></a><span class="kw">ggplot</span>(df_long, <span class="kw">aes</span>(<span class="dt">x =</span> Variable, <span class="dt">y=</span><span class="st">`</span><span class="dt">Widgets purchased</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb133-12"><a href="solutions-for-code-challenges.html#cb133-12"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb133-13"><a href="solutions-for-code-challenges.html#cb133-13"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st">`</span><span class="dt">Variable name</span><span class="st">`</span>, <span class="dt">scales=</span><span class="st">&quot;free_x&quot;</span>)</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e14-4-1.png" width="672" /></p>
</div>
<div id="exercise-5" class="section level3 unnumbered" number="">
<h3>Exercise 5</h3>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="solutions-for-code-challenges.html#cb134-1"></a>yHat &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta</span>
<span id="cb134-2"><a href="solutions-for-code-challenges.html#cb134-2"></a>r2 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>((yHat <span class="op">-</span><span class="st"> </span>y)<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>((y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y))<span class="op">^</span><span class="dv">2</span>)</span></code></pre></div>
</div>
</div>
<div id="chapter-15-1" class="section level2 unnumbered" number="">
<h2>Chapter 15</h2>
<div id="exercise-1-9" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="solutions-for-code-challenges.html#cb135-1"></a>avediffs &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times=</span><span class="dv">100</span>)</span>
<span id="cb135-2"><a href="solutions-for-code-challenges.html#cb135-2"></a><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</span>
<span id="cb135-3"><a href="solutions-for-code-challenges.html#cb135-3"></a>  A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span>n<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span>n, <span class="dt">ncol=</span>n)</span>
<span id="cb135-4"><a href="solutions-for-code-challenges.html#cb135-4"></a>  B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span>n<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span>n, <span class="dt">ncol=</span>n)</span>
<span id="cb135-5"><a href="solutions-for-code-challenges.html#cb135-5"></a>  l1 &lt;-<span class="st"> </span>geigen<span class="op">::</span><span class="kw">geigen</span>(A, B, <span class="dt">symmetric=</span><span class="ot">FALSE</span>, <span class="dt">only.values=</span><span class="ot">TRUE</span>)<span class="op">$</span>values</span>
<span id="cb135-6"><a href="solutions-for-code-challenges.html#cb135-6"></a>  l2 &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">solve</span>(B) <span class="op">%*%</span><span class="st"> </span>A)<span class="op">$</span>values</span>
<span id="cb135-7"><a href="solutions-for-code-challenges.html#cb135-7"></a>  </span>
<span id="cb135-8"><a href="solutions-for-code-challenges.html#cb135-8"></a>  <span class="co"># important to sort eigvals</span></span>
<span id="cb135-9"><a href="solutions-for-code-challenges.html#cb135-9"></a>  l1 &lt;-<span class="st"> </span><span class="kw">sort</span>(l1)</span>
<span id="cb135-10"><a href="solutions-for-code-challenges.html#cb135-10"></a>  l2 &lt;-<span class="st"> </span><span class="kw">sort</span>(l2)</span>
<span id="cb135-11"><a href="solutions-for-code-challenges.html#cb135-11"></a>  </span>
<span id="cb135-12"><a href="solutions-for-code-challenges.html#cb135-12"></a>  avediffs[n] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(l1<span class="op">-</span>l2))</span>
<span id="cb135-13"><a href="solutions-for-code-challenges.html#cb135-13"></a>}</span>
<span id="cb135-14"><a href="solutions-for-code-challenges.html#cb135-14"></a></span>
<span id="cb135-15"><a href="solutions-for-code-challenges.html#cb135-15"></a><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">y=</span>avediffs)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb135-16"><a href="solutions-for-code-challenges.html#cb135-16"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb135-17"><a href="solutions-for-code-challenges.html#cb135-17"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Matrix size&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb135-18"><a href="solutions-for-code-challenges.html#cb135-18"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(Delta, lambda)))</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e15-1-1.png" width="672" /></p>
</div>
<div id="exercise-2-10" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="solutions-for-code-challenges.html#cb136-1"></a>A &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb136-2"><a href="solutions-for-code-challenges.html#cb136-2"></a>eigenA &lt;-<span class="st"> </span><span class="kw">eigen</span>(A)</span>
<span id="cb136-3"><a href="solutions-for-code-challenges.html#cb136-3"></a>L &lt;-<span class="st"> </span>eigenA<span class="op">$</span>values</span>
<span id="cb136-4"><a href="solutions-for-code-challenges.html#cb136-4"></a>V &lt;-<span class="st"> </span>eigenA<span class="op">$</span>vectors</span></code></pre></div>
</div>
<div id="exercise-3-4" class="section level3 unnumbered" number="">
<h3>Exercise 3</h3>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="solutions-for-code-challenges.html#cb137-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb137-2"><a href="solutions-for-code-challenges.html#cb137-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb137-3"><a href="solutions-for-code-challenges.html#cb137-3"></a><span class="kw">library</span>(patchwork)</span>
<span id="cb137-4"><a href="solutions-for-code-challenges.html#cb137-4"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb137-5"><a href="solutions-for-code-challenges.html#cb137-5"></a></span>
<span id="cb137-6"><a href="solutions-for-code-challenges.html#cb137-6"></a>v &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">50</span></span>
<span id="cb137-7"><a href="solutions-for-code-challenges.html#cb137-7"></a>lstrow &lt;-<span class="st"> </span><span class="kw">c</span>(v[<span class="kw">length</span>(v)], v[<span class="op">-</span><span class="kw">length</span>(v)])</span>
<span id="cb137-8"><a href="solutions-for-code-challenges.html#cb137-8"></a>H &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">hankel</span>(v, lstrow)</span>
<span id="cb137-9"><a href="solutions-for-code-challenges.html#cb137-9"></a>eigH &lt;-<span class="st"> </span><span class="kw">eigen</span>(H)</span>
<span id="cb137-10"><a href="solutions-for-code-challenges.html#cb137-10"></a>V &lt;-<span class="st"> </span>eigH<span class="op">$</span>vectors[, <span class="kw">order</span>(eigH<span class="op">$</span>values, <span class="dt">decreasing=</span><span class="ot">TRUE</span>)]</span>
<span id="cb137-11"><a href="solutions-for-code-challenges.html#cb137-11"></a></span>
<span id="cb137-12"><a href="solutions-for-code-challenges.html#cb137-12"></a><span class="co"># the matrix</span></span>
<span id="cb137-13"><a href="solutions-for-code-challenges.html#cb137-13"></a>plotH &lt;-<span class="st"> </span></span>
<span id="cb137-14"><a href="solutions-for-code-challenges.html#cb137-14"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data=</span>reshape2<span class="op">::</span><span class="kw">melt</span>(H), <span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">1</span><span class="op">-</span>Var1, <span class="dt">y=</span>Var2)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-15"><a href="solutions-for-code-challenges.html#cb137-15"></a><span class="st">  </span><span class="kw">geom_raster</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>value), <span class="dt">show.legend=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-16"><a href="solutions-for-code-challenges.html#cb137-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Hankel matrix&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-17"><a href="solutions-for-code-challenges.html#cb137-17"></a><span class="st">  </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb137-18"><a href="solutions-for-code-challenges.html#cb137-18"></a>  </span>
<span id="cb137-19"><a href="solutions-for-code-challenges.html#cb137-19"></a></span>
<span id="cb137-20"><a href="solutions-for-code-challenges.html#cb137-20"></a><span class="co"># eigenvector matrix</span></span>
<span id="cb137-21"><a href="solutions-for-code-challenges.html#cb137-21"></a>plotV &lt;-<span class="st"> </span></span>
<span id="cb137-22"><a href="solutions-for-code-challenges.html#cb137-22"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data=</span>reshape2<span class="op">::</span><span class="kw">melt</span>(V), <span class="kw">aes</span>(<span class="dt">x=</span>Var2, <span class="dt">y=</span>Var1)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-23"><a href="solutions-for-code-challenges.html#cb137-23"></a><span class="st">  </span><span class="kw">geom_raster</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>value), <span class="dt">show.legend=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-24"><a href="solutions-for-code-challenges.html#cb137-24"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Eigenvector matrix&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-25"><a href="solutions-for-code-challenges.html#cb137-25"></a><span class="st">  </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb137-26"><a href="solutions-for-code-challenges.html#cb137-26"></a></span>
<span id="cb137-27"><a href="solutions-for-code-challenges.html#cb137-27"></a><span class="co"># a few eigenvectors</span></span>
<span id="cb137-28"><a href="solutions-for-code-challenges.html#cb137-28"></a>dfV &lt;-<span class="st"> </span></span>
<span id="cb137-29"><a href="solutions-for-code-challenges.html#cb137-29"></a><span class="st">  </span><span class="kw">data.frame</span>(<span class="kw">t</span>(V)) <span class="op">%&gt;%</span></span>
<span id="cb137-30"><a href="solutions-for-code-challenges.html#cb137-30"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">slice_head</span>(<span class="dt">n=</span><span class="dv">4</span>) <span class="op">%&gt;%</span></span>
<span id="cb137-31"><a href="solutions-for-code-challenges.html#cb137-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">VectorIndex =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb137-32"><a href="solutions-for-code-challenges.html#cb137-32"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(X1<span class="op">:</span>X50), <span class="dt">names_to=</span><span class="st">&quot;Element&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;Value&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb137-33"><a href="solutions-for-code-challenges.html#cb137-33"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(VectorIndex) <span class="op">%&gt;%</span></span>
<span id="cb137-34"><a href="solutions-for-code-challenges.html#cb137-34"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">ElementIndex =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb137-35"><a href="solutions-for-code-challenges.html#cb137-35"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Element)</span>
<span id="cb137-36"><a href="solutions-for-code-challenges.html#cb137-36"></a></span>
<span id="cb137-37"><a href="solutions-for-code-challenges.html#cb137-37"></a>plot4 &lt;-<span class="st"> </span></span>
<span id="cb137-38"><a href="solutions-for-code-challenges.html#cb137-38"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data=</span>dfV, <span class="kw">aes</span>(<span class="dt">x =</span> ElementIndex, <span class="dt">y=</span>Value, <span class="dt">color=</span><span class="kw">as.factor</span>(VectorIndex))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-39"><a href="solutions-for-code-challenges.html#cb137-39"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">show.legend=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-40"><a href="solutions-for-code-challenges.html#cb137-40"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">show.legend=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-41"><a href="solutions-for-code-challenges.html#cb137-41"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Eigenvector element index&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-42"><a href="solutions-for-code-challenges.html#cb137-42"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Eigenvector element value&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-43"><a href="solutions-for-code-challenges.html#cb137-43"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;First four eigenvectors&quot;</span>)</span>
<span id="cb137-44"><a href="solutions-for-code-challenges.html#cb137-44"></a></span>
<span id="cb137-45"><a href="solutions-for-code-challenges.html#cb137-45"></a>(plotH <span class="op">|</span><span class="st"> </span>plotV) <span class="op">/</span><span class="st"> </span>plot4</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e15-3-1.png" width="672" /></p>
</div>
</div>
<div id="chapter-16-1" class="section level2 unnumbered" number="">
<h2>Chapter 16</h2>
<div id="exercise-1-10" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<p>In R <a href="https://stat.ethz.ch/R-manual/R-patched/library/base/html/svd.html">svd()</a> defaults to “economy” mode. If you want the full matrix, you must specify dimensions for <strong>U</strong> and <strong>V</strong> explicitly.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="solutions-for-code-challenges.html#cb138-1"></a>m &lt;-<span class="st"> </span><span class="dv">6</span></span>
<span id="cb138-2"><a href="solutions-for-code-challenges.html#cb138-2"></a>n &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb138-3"><a href="solutions-for-code-challenges.html#cb138-3"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span>m<span class="op">*</span>n), <span class="dt">nrow=</span>m, <span class="dt">ncol=</span>n)</span>
<span id="cb138-4"><a href="solutions-for-code-challenges.html#cb138-4"></a></span>
<span id="cb138-5"><a href="solutions-for-code-challenges.html#cb138-5"></a>fullSVD &lt;-<span class="st"> </span><span class="kw">svd</span>(A, <span class="dt">nu=</span>m, <span class="dt">nv=</span>n)</span>
<span id="cb138-6"><a href="solutions-for-code-challenges.html#cb138-6"></a>economySVD &lt;-<span class="st"> </span><span class="kw">svd</span>(A)</span>
<span id="cb138-7"><a href="solutions-for-code-challenges.html#cb138-7"></a></span>
<span id="cb138-8"><a href="solutions-for-code-challenges.html#cb138-8"></a><span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;Full SVD: (%d, %d), %d, (%d, %d)</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="kw">nrow</span>(fullSVD<span class="op">$</span>u), <span class="kw">ncol</span>(fullSVD<span class="op">$</span>u), <span class="kw">length</span>(fullSVD<span class="op">$</span>d), <span class="kw">nrow</span>(fullSVD<span class="op">$</span>v), <span class="kw">ncol</span>(fullSVD<span class="op">$</span>v)))</span></code></pre></div>
<pre><code>## Full SVD: (6, 6), 3, (3, 3)</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="solutions-for-code-challenges.html#cb140-1"></a><span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;Economy : (%d, %d), %d, (%d, %d)</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="kw">nrow</span>(economySVD<span class="op">$</span>u), <span class="kw">ncol</span>(economySVD<span class="op">$</span>u), <span class="kw">length</span>(economySVD<span class="op">$</span>d), <span class="kw">nrow</span>(economySVD<span class="op">$</span>v), <span class="kw">ncol</span>(economySVD<span class="op">$</span>v)))</span></code></pre></div>
<pre><code>## Economy : (6, 3), 3, (3, 3)</code></pre>
</div>
<div id="exercise-2-11" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<p>Note that <a href="">eigen()</a> sorts eigenvalues and eigenvectors, so sorting is redundant and can be skipped (but I kept it to match the original code).</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="solutions-for-code-challenges.html#cb142-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">5</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">5</span>) <span class="co"># matrix</span></span>
<span id="cb142-2"><a href="solutions-for-code-challenges.html#cb142-2"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(a, <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">5</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb142-3"><a href="solutions-for-code-challenges.html#cb142-3"></a>eigAV &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">t</span>(A) <span class="op">%*%</span><span class="st"> </span>A) </span>
<span id="cb142-4"><a href="solutions-for-code-challenges.html#cb142-4"></a>V &lt;-<span class="st">  </span>eigAV<span class="op">$</span>vectors[, <span class="kw">order</span>(eigAV<span class="op">$</span>values, <span class="dt">decreasing=</span><span class="ot">TRUE</span>)] <span class="co"># sort descent V</span></span>
<span id="cb142-5"><a href="solutions-for-code-challenges.html#cb142-5"></a>eigAU &lt;-<span class="st"> </span><span class="kw">eigen</span>(A <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(A)) </span>
<span id="cb142-6"><a href="solutions-for-code-challenges.html#cb142-6"></a>U &lt;-<span class="st">  </span>eigAU<span class="op">$</span>vectors[, <span class="kw">order</span>(eigAU<span class="op">$</span>values, <span class="dt">decreasing=</span><span class="ot">TRUE</span>)] <span class="co"># sort descent U</span></span>
<span id="cb142-7"><a href="solutions-for-code-challenges.html#cb142-7"></a></span>
<span id="cb142-8"><a href="solutions-for-code-challenges.html#cb142-8"></a><span class="co"># create Sigma</span></span>
<span id="cb142-9"><a href="solutions-for-code-challenges.html#cb142-9"></a>sorted_values &lt;-<span class="st"> </span><span class="kw">sort</span>(eigAU<span class="op">$</span>values, <span class="dt">decreasing=</span><span class="ot">TRUE</span>)</span>
<span id="cb142-10"><a href="solutions-for-code-challenges.html#cb142-10"></a>S &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="kw">nrow</span>(A), <span class="dt">ncol=</span><span class="kw">ncol</span>(A))</span>
<span id="cb142-11"><a href="solutions-for-code-challenges.html#cb142-11"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sorted_values)){</span>
<span id="cb142-12"><a href="solutions-for-code-challenges.html#cb142-12"></a>  S[i, i] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(sorted_values[i])</span>
<span id="cb142-13"><a href="solutions-for-code-challenges.html#cb142-13"></a>}</span>
<span id="cb142-14"><a href="solutions-for-code-challenges.html#cb142-14"></a></span>
<span id="cb142-15"><a href="solutions-for-code-challenges.html#cb142-15"></a>svdA &lt;-<span class="st"> </span><span class="kw">svd</span>(A) <span class="co"># svd</span></span></code></pre></div>
</div>
<div id="exercise-3-5" class="section level3 unnumbered" number="">
<h3>Exercise 3</h3>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="solutions-for-code-challenges.html#cb143-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb143-2"><a href="solutions-for-code-challenges.html#cb143-2"></a><span class="kw">library</span>(patchwork)</span>
<span id="cb143-3"><a href="solutions-for-code-challenges.html#cb143-3"></a><span class="kw">library</span>(RColorBrewer)</span>
<span id="cb143-4"><a href="solutions-for-code-challenges.html#cb143-4"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb143-5"><a href="solutions-for-code-challenges.html#cb143-5"></a></span>
<span id="cb143-6"><a href="solutions-for-code-challenges.html#cb143-6"></a></span>
<span id="cb143-7"><a href="solutions-for-code-challenges.html#cb143-7"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">5</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb143-8"><a href="solutions-for-code-challenges.html#cb143-8"></a>svdA &lt;-<span class="st"> </span><span class="kw">svd</span>(A)</span>
<span id="cb143-9"><a href="solutions-for-code-challenges.html#cb143-9"></a>S &lt;-<span class="st"> </span><span class="kw">diag</span>(svdA<span class="op">$</span>d) <span class="co"># need Sigma matrix</span></span>
<span id="cb143-10"><a href="solutions-for-code-challenges.html#cb143-10"></a></span>
<span id="cb143-11"><a href="solutions-for-code-challenges.html#cb143-11"></a>fill_palette &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">rev</span>(<span class="kw">brewer.pal</span>(<span class="dv">11</span>, <span class="st">&quot;Spectral&quot;</span>)))</span>
<span id="cb143-12"><a href="solutions-for-code-challenges.html#cb143-12"></a>sc &lt;-<span class="st"> </span><span class="kw">scale_colour_gradientn</span>(<span class="dt">colours =</span> <span class="kw">fill_palette</span>(<span class="dv">100</span>), <span class="dt">limits=</span><span class="kw">c</span>(<span class="kw">min</span>(A), <span class="kw">max</span>(A)))</span>
<span id="cb143-13"><a href="solutions-for-code-challenges.html#cb143-13"></a></span>
<span id="cb143-14"><a href="solutions-for-code-challenges.html#cb143-14"></a></span>
<span id="cb143-15"><a href="solutions-for-code-challenges.html#cb143-15"></a>one_layer_plots &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb143-16"><a href="solutions-for-code-challenges.html#cb143-16"></a>lowrank_plots &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb143-17"><a href="solutions-for-code-challenges.html#cb143-17"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</span>
<span id="cb143-18"><a href="solutions-for-code-challenges.html#cb143-18"></a>  onelayer &lt;-<span class="st"> </span><span class="kw">outer</span>(svdA<span class="op">$</span>u[, i], svdA<span class="op">$</span>v[i, ]) <span class="op">*</span><span class="st"> </span>svdA<span class="op">$</span>d[i]</span>
<span id="cb143-19"><a href="solutions-for-code-challenges.html#cb143-19"></a>  one_layer_plots[[i]] &lt;-<span class="st"> </span></span>
<span id="cb143-20"><a href="solutions-for-code-challenges.html#cb143-20"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="dt">data=</span>reshape2<span class="op">::</span><span class="kw">melt</span>(<span class="kw">t</span>(onelayer)), <span class="kw">aes</span>(<span class="dt">x=</span>Var1, <span class="dt">y=</span>Var2, <span class="dt">fill=</span>value)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb143-21"><a href="solutions-for-code-challenges.html#cb143-21"></a><span class="st">    </span><span class="kw">geom_tile</span>(<span class="dt">show.legend=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb143-22"><a href="solutions-for-code-challenges.html#cb143-22"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="kw">sprintf</span>(<span class="st">&quot;Layer %d&quot;</span>, i)) <span class="op">+</span></span>
<span id="cb143-23"><a href="solutions-for-code-challenges.html#cb143-23"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span>sc</span>
<span id="cb143-24"><a href="solutions-for-code-challenges.html#cb143-24"></a>  </span>
<span id="cb143-25"><a href="solutions-for-code-challenges.html#cb143-25"></a>  lowrank &lt;-<span class="st"> </span><span class="kw">matrix</span>(svdA<span class="op">$</span>u[, <span class="dv">1</span><span class="op">:</span>i], <span class="dt">ncol=</span>i) <span class="op">%*%</span><span class="st"> </span>S[<span class="dv">1</span><span class="op">:</span>i,<span class="dv">1</span><span class="op">:</span>i] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(svdA<span class="op">$</span>v)[<span class="dv">1</span><span class="op">:</span>i,]</span>
<span id="cb143-26"><a href="solutions-for-code-challenges.html#cb143-26"></a>  lowrank_plots[[i]] &lt;-<span class="st"> </span></span>
<span id="cb143-27"><a href="solutions-for-code-challenges.html#cb143-27"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="dt">data=</span>reshape2<span class="op">::</span><span class="kw">melt</span>(<span class="kw">t</span>(lowrank)), <span class="kw">aes</span>(<span class="dt">x=</span>Var1, <span class="dt">y=</span>Var2, <span class="dt">fill=</span>value)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb143-28"><a href="solutions-for-code-challenges.html#cb143-28"></a><span class="st">    </span><span class="kw">geom_tile</span>(<span class="dt">show.legend=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb143-29"><a href="solutions-for-code-challenges.html#cb143-29"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="kw">sprintf</span>(<span class="st">&quot;Layers 1:%d&quot;</span>, i)) <span class="op">+</span></span>
<span id="cb143-30"><a href="solutions-for-code-challenges.html#cb143-30"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span>sc</span>
<span id="cb143-31"><a href="solutions-for-code-challenges.html#cb143-31"></a>}</span>
<span id="cb143-32"><a href="solutions-for-code-challenges.html#cb143-32"></a></span>
<span id="cb143-33"><a href="solutions-for-code-challenges.html#cb143-33"></a>plotA &lt;-<span class="st"> </span></span>
<span id="cb143-34"><a href="solutions-for-code-challenges.html#cb143-34"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data=</span>reshape2<span class="op">::</span><span class="kw">melt</span>(<span class="kw">t</span>(A)), <span class="kw">aes</span>(<span class="dt">x=</span>Var1, <span class="dt">y=</span>Var2, <span class="dt">fill=</span>value)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb143-35"><a href="solutions-for-code-challenges.html#cb143-35"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">show.legend=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb143-36"><a href="solutions-for-code-challenges.html#cb143-36"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Orig. A&quot;</span>) <span class="op">+</span></span>
<span id="cb143-37"><a href="solutions-for-code-challenges.html#cb143-37"></a><span class="st">  </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span>sc</span>
<span id="cb143-38"><a href="solutions-for-code-challenges.html#cb143-38"></a></span>
<span id="cb143-39"><a href="solutions-for-code-challenges.html#cb143-39"></a>layout &lt;-<span class="st"> &quot;</span></span>
<span id="cb143-40"><a href="solutions-for-code-challenges.html#cb143-40"></a><span class="st">ABC#</span></span>
<span id="cb143-41"><a href="solutions-for-code-challenges.html#cb143-41"></a><span class="st">DEFG</span></span>
<span id="cb143-42"><a href="solutions-for-code-challenges.html#cb143-42"></a><span class="st">&quot;</span></span>
<span id="cb143-43"><a href="solutions-for-code-challenges.html#cb143-43"></a>one_layer_plots[[<span class="dv">1</span>]] <span class="op">+</span><span class="st"> </span>one_layer_plots[[<span class="dv">2</span>]] <span class="op">+</span><span class="st"> </span>one_layer_plots[[<span class="dv">3</span>]] <span class="op">+</span></span>
<span id="cb143-44"><a href="solutions-for-code-challenges.html#cb143-44"></a><span class="st">  </span>lowrank_plots[[<span class="dv">1</span>]] <span class="op">+</span><span class="st"> </span>lowrank_plots[[<span class="dv">2</span>]] <span class="op">+</span><span class="st"> </span>lowrank_plots[[<span class="dv">3</span>]] <span class="op">+</span><span class="st"> </span>plotA <span class="op">+</span></span>
<span id="cb143-45"><a href="solutions-for-code-challenges.html#cb143-45"></a><span class="st">  </span><span class="kw">plot_layout</span>(<span class="dt">design =</span> layout)</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e16-3-1.png" width="672" /></p>
</div>
<div id="exercise-4-2" class="section level3 unnumbered" number="">
<h3>Exercise 4</h3>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="solutions-for-code-challenges.html#cb144-1"></a>m &lt;-<span class="st"> </span><span class="dv">6</span></span>
<span id="cb144-2"><a href="solutions-for-code-challenges.html#cb144-2"></a>n &lt;-<span class="st"> </span><span class="dv">16</span></span>
<span id="cb144-3"><a href="solutions-for-code-challenges.html#cb144-3"></a>condnum &lt;-<span class="st"> </span><span class="dv">42</span></span>
<span id="cb144-4"><a href="solutions-for-code-challenges.html#cb144-4"></a></span>
<span id="cb144-5"><a href="solutions-for-code-challenges.html#cb144-5"></a><span class="co"># create U and V from random numbers</span></span>
<span id="cb144-6"><a href="solutions-for-code-challenges.html#cb144-6"></a>U &lt;-<span class="st"> </span><span class="kw">qr</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(m<span class="op">*</span>m), <span class="dt">nrow=</span>m, <span class="dt">ncol=</span>m))</span>
<span id="cb144-7"><a href="solutions-for-code-challenges.html#cb144-7"></a>V &lt;-<span class="st"> </span><span class="kw">qr</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span>n), <span class="dt">nrow=</span>n, <span class="dt">ncol=</span>n))</span>
<span id="cb144-8"><a href="solutions-for-code-challenges.html#cb144-8"></a></span>
<span id="cb144-9"><a href="solutions-for-code-challenges.html#cb144-9"></a><span class="co"># create singular values vector</span></span>
<span id="cb144-10"><a href="solutions-for-code-challenges.html#cb144-10"></a>s &lt;-<span class="st"> </span><span class="kw">seq</span>(condnum, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="kw">min</span>(<span class="kw">c</span>(m,n)))</span>
<span id="cb144-11"><a href="solutions-for-code-challenges.html#cb144-11"></a>S &lt;-<span class="st"> </span><span class="kw">diag</span>(s, <span class="dt">nrow=</span>m, <span class="dt">ncol=</span>n)</span>
<span id="cb144-12"><a href="solutions-for-code-challenges.html#cb144-12"></a><span class="co"># ↓ original code ↓</span></span>
<span id="cb144-13"><a href="solutions-for-code-challenges.html#cb144-13"></a><span class="co"># S &lt;- matrix(0, nrow=m, ncol=n)</span></span>
<span id="cb144-14"><a href="solutions-for-code-challenges.html#cb144-14"></a><span class="co"># for(i in 1:min(c(m, n))){</span></span>
<span id="cb144-15"><a href="solutions-for-code-challenges.html#cb144-15"></a><span class="co">#   S[i, i] &lt;- s[i]</span></span>
<span id="cb144-16"><a href="solutions-for-code-challenges.html#cb144-16"></a><span class="co"># }</span></span>
<span id="cb144-17"><a href="solutions-for-code-challenges.html#cb144-17"></a></span>
<span id="cb144-18"><a href="solutions-for-code-challenges.html#cb144-18"></a>A &lt;-<span class="st"> </span><span class="kw">qr.Q</span>(U) <span class="op">%*%</span><span class="st"> </span>S <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(<span class="kw">qr.Q</span>(V)) <span class="co"># construct matrix</span></span>
<span id="cb144-19"><a href="solutions-for-code-challenges.html#cb144-19"></a>pracma<span class="op">::</span><span class="kw">cond</span>(A)</span></code></pre></div>
<pre><code>## [1] 42</code></pre>
</div>
<div id="exercise-5-1" class="section level3 unnumbered" number="">
<h3>Exercise 5</h3>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="solutions-for-code-challenges.html#cb146-1"></a><span class="kw">library</span>(imager)</span>
<span id="cb146-2"><a href="solutions-for-code-challenges.html#cb146-2"></a></span>
<span id="cb146-3"><a href="solutions-for-code-challenges.html#cb146-3"></a>rankN &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb146-4"><a href="solutions-for-code-challenges.html#cb146-4"></a></span>
<span id="cb146-5"><a href="solutions-for-code-challenges.html#cb146-5"></a>picture &lt;-<span class="st"> </span>imager<span class="op">::</span><span class="kw">load.image</span>(<span class="st">&#39;https://upload.wikimedia.org/wikipedia/en/8/86/Einstein_tongue.jpg&#39;</span>)</span>
<span id="cb146-6"><a href="solutions-for-code-challenges.html#cb146-6"></a></span>
<span id="cb146-7"><a href="solutions-for-code-challenges.html#cb146-7"></a>pic &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(picture)</span>
<span id="cb146-8"><a href="solutions-for-code-challenges.html#cb146-8"></a>picSVD &lt;-<span class="st"> </span><span class="kw">svd</span>(pic, <span class="dt">nu=</span><span class="kw">nrow</span>(pic), <span class="dt">nv=</span><span class="kw">ncol</span>(pic))</span>
<span id="cb146-9"><a href="solutions-for-code-challenges.html#cb146-9"></a>S &lt;-<span class="st"> </span><span class="kw">diag</span>(picSVD<span class="op">$</span>d, <span class="dt">nrow=</span><span class="kw">nrow</span>(pic), <span class="dt">ncol=</span><span class="kw">ncol</span>(pic))</span>
<span id="cb146-10"><a href="solutions-for-code-challenges.html#cb146-10"></a></span>
<span id="cb146-11"><a href="solutions-for-code-challenges.html#cb146-11"></a>lowrank &lt;-<span class="st"> </span>picSVD<span class="op">$</span>u[, <span class="dv">1</span><span class="op">:</span>rankN] <span class="op">%*%</span><span class="st"> </span>S[<span class="dv">1</span><span class="op">:</span>rankN, <span class="dv">1</span><span class="op">:</span>rankN] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(picSVD<span class="op">$</span>v)[<span class="dv">1</span><span class="op">:</span>rankN,]</span>
<span id="cb146-12"><a href="solutions-for-code-challenges.html#cb146-12"></a></span>
<span id="cb146-13"><a href="solutions-for-code-challenges.html#cb146-13"></a><span class="kw">plot</span>(imager<span class="op">::</span><span class="kw">as.cimg</span>(lowrank), <span class="dt">axes=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e16-5-1.png" width="672" /></p>
</div>
<div id="exercise-6" class="section level3 unnumbered" number="">
<h3>Exercise 6</h3>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="solutions-for-code-challenges.html#cb147-1"></a><span class="kw">library</span>(imager)</span>
<span id="cb147-2"><a href="solutions-for-code-challenges.html#cb147-2"></a></span>
<span id="cb147-3"><a href="solutions-for-code-challenges.html#cb147-3"></a><span class="co"># convert to percent explained</span></span>
<span id="cb147-4"><a href="solutions-for-code-challenges.html#cb147-4"></a>s &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>picSVD<span class="op">$</span>d <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(picSVD<span class="op">$</span>d)</span>
<span id="cb147-5"><a href="solutions-for-code-challenges.html#cb147-5"></a><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">y=</span>s[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb147-6"><a href="solutions-for-code-challenges.html#cb147-6"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb147-7"><a href="solutions-for-code-challenges.html#cb147-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb147-8"><a href="solutions-for-code-challenges.html#cb147-8"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Component number&quot;</span>) <span class="op">+</span></span>
<span id="cb147-9"><a href="solutions-for-code-challenges.html#cb147-9"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Pct variance explains&quot;</span>)</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e16-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="solutions-for-code-challenges.html#cb148-1"></a>thresh &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co"># threshold in percent</span></span>
<span id="cb148-2"><a href="solutions-for-code-challenges.html#cb148-2"></a>comps &lt;-<span class="st"> </span>s <span class="op">&gt;</span><span class="st"> </span>thresh <span class="co"># comps greater than X%</span></span>
<span id="cb148-3"><a href="solutions-for-code-challenges.html#cb148-3"></a>lowrank &lt;-<span class="st"> </span>picSVD<span class="op">$</span>u[, comps] <span class="op">%*%</span><span class="st"> </span>S[comps, comps] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(picSVD<span class="op">$</span>v)[comps,]</span>
<span id="cb148-4"><a href="solutions-for-code-challenges.html#cb148-4"></a></span>
<span id="cb148-5"><a href="solutions-for-code-challenges.html#cb148-5"></a><span class="kw">layout</span>(<span class="kw">t</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb148-6"><a href="solutions-for-code-challenges.html#cb148-6"></a><span class="kw">plot</span>(picture, <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">main=</span><span class="st">&quot;Original&quot;</span>)</span>
<span id="cb148-7"><a href="solutions-for-code-challenges.html#cb148-7"></a><span class="kw">plot</span>(<span class="kw">as.cimg</span>(lowrank), <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">main=</span><span class="kw">sprintf</span>(<span class="st">&quot;%s comps with &gt; %g%%&quot;</span>, <span class="kw">sum</span>(comps), thresh))</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e16-6-2.png" width="672" /></p>
</div>
<div id="exercise-7" class="section level3 unnumbered" number="">
<h3>Exercise 7</h3>
<p>Note <code>matrix(picSVD$u[, 1:si], ncol=si)</code>. Without <code>matrix(, ncol=si)</code>, <code>picSVD$u[, 1:si]</code> becomes an atomic vector and matrix multiplication breaks down.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="solutions-for-code-challenges.html#cb149-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb149-2"><a href="solutions-for-code-challenges.html#cb149-2"></a></span>
<span id="cb149-3"><a href="solutions-for-code-challenges.html#cb149-3"></a>RMS &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(s))</span>
<span id="cb149-4"><a href="solutions-for-code-challenges.html#cb149-4"></a><span class="cf">for</span>(si <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(s)){</span>
<span id="cb149-5"><a href="solutions-for-code-challenges.html#cb149-5"></a>  lowrank &lt;-<span class="st"> </span><span class="kw">matrix</span>(picSVD<span class="op">$</span>u[, <span class="dv">1</span><span class="op">:</span>si], <span class="dt">ncol=</span>si) <span class="op">%*%</span><span class="st"> </span>S[<span class="dv">1</span><span class="op">:</span>si, <span class="dv">1</span><span class="op">:</span>si] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(picSVD<span class="op">$</span>v)[<span class="dv">1</span><span class="op">:</span>si,]</span>
<span id="cb149-6"><a href="solutions-for-code-challenges.html#cb149-6"></a>  diffimg &lt;-<span class="st"> </span>lowrank <span class="op">-</span><span class="st"> </span>pic</span>
<span id="cb149-7"><a href="solutions-for-code-challenges.html#cb149-7"></a>  RMS[si] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(diffimg<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb149-8"><a href="solutions-for-code-challenges.html#cb149-8"></a>}</span>
<span id="cb149-9"><a href="solutions-for-code-challenges.html#cb149-9"></a></span>
<span id="cb149-10"><a href="solutions-for-code-challenges.html#cb149-10"></a><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(RMS), <span class="dt">y=</span>RMS)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb149-11"><a href="solutions-for-code-challenges.html#cb149-11"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb149-12"><a href="solutions-for-code-challenges.html#cb149-12"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Rank approximation&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb149-13"><a href="solutions-for-code-challenges.html#cb149-13"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Error (a.u.)&quot;</span>)</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e16-7-1.png" width="672" /></p>
</div>
<div id="exercise-8" class="section level3 unnumbered" number="">
<h3>Exercise 8</h3>
<p>Reminder, you need to specify <code>nu</code> and <code>nv</code> to ensure full matrices U and V.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="solutions-for-code-challenges.html#cb150-1"></a><span class="kw">library</span>(matrixcalc)</span>
<span id="cb150-2"><a href="solutions-for-code-challenges.html#cb150-2"></a></span>
<span id="cb150-3"><a href="solutions-for-code-challenges.html#cb150-3"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">4</span><span class="op">*</span><span class="dv">2</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb150-4"><a href="solutions-for-code-challenges.html#cb150-4"></a>svdX &lt;-<span class="st"> </span><span class="kw">svd</span>(X, <span class="dt">nu=</span><span class="kw">nrow</span>(X), <span class="dt">nv=</span><span class="kw">ncol</span>(X)) <span class="co"># eq. 29</span></span>
<span id="cb150-5"><a href="solutions-for-code-challenges.html#cb150-5"></a>U &lt;-<span class="st"> </span>svdX<span class="op">$</span>u</span>
<span id="cb150-6"><a href="solutions-for-code-challenges.html#cb150-6"></a>S &lt;-<span class="st"> </span><span class="kw">diag</span>(svdX<span class="op">$</span>d, <span class="dt">nrow=</span><span class="kw">nrow</span>(X), <span class="dt">ncol=</span><span class="kw">ncol</span>(X))</span>
<span id="cb150-7"><a href="solutions-for-code-challenges.html#cb150-7"></a>V &lt;-<span class="st"> </span>svdX<span class="op">$</span>v</span>
<span id="cb150-8"><a href="solutions-for-code-challenges.html#cb150-8"></a></span>
<span id="cb150-9"><a href="solutions-for-code-challenges.html#cb150-9"></a>longV1 &lt;-<span class="st"> </span><span class="kw">solve</span>(<span class="kw">t</span>(U<span class="op">%*%</span>S<span class="op">%*%</span><span class="kw">t</span>(V))<span class="op">%*%</span>U<span class="op">%*%</span>S<span class="op">%*%</span><span class="kw">t</span>(V)) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(U<span class="op">%*%</span>S<span class="op">%*%</span><span class="kw">t</span>(V)) <span class="co"># eq. 30</span></span>
<span id="cb150-10"><a href="solutions-for-code-challenges.html#cb150-10"></a>longV2 &lt;-<span class="st"> </span><span class="kw">solve</span>(V<span class="op">%*%</span><span class="kw">t</span>(S)<span class="op">%*%</span><span class="kw">t</span>(U)<span class="op">%*%</span>U<span class="op">%*%</span>S<span class="op">%*%</span><span class="kw">t</span>(V)) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(U<span class="op">%*%</span>S<span class="op">%*%</span><span class="kw">t</span>(V)) <span class="co"># eq. 31</span></span>
<span id="cb150-11"><a href="solutions-for-code-challenges.html#cb150-11"></a>longV3 &lt;-<span class="st"> </span><span class="kw">solve</span>(V<span class="op">%*%</span><span class="kw">t</span>(S)<span class="op">%*%</span>S<span class="op">%*%</span><span class="kw">t</span>(V)) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(U<span class="op">%*%</span>S<span class="op">%*%</span><span class="kw">t</span>(V)) <span class="co"># eq. 32</span></span>
<span id="cb150-12"><a href="solutions-for-code-challenges.html#cb150-12"></a>longV4 &lt;-<span class="st"> </span>V <span class="op">%*%</span><span class="st"> </span>matrixcalc<span class="op">::</span><span class="kw">matrix.power</span>(<span class="kw">t</span>(S) <span class="op">%*%</span><span class="st"> </span>S, <span class="dv">-1</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(V)<span class="op">%*%</span>V<span class="op">%*%</span><span class="kw">t</span>(S)<span class="op">%*%</span><span class="kw">t</span>(U) <span class="co"># eq. 33 </span></span>
<span id="cb150-13"><a href="solutions-for-code-challenges.html#cb150-13"></a></span>
<span id="cb150-14"><a href="solutions-for-code-challenges.html#cb150-14"></a>MPpinv &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">pinv</span>(X) <span class="co"># eq. 34</span></span></code></pre></div>
</div>
<div id="exercise-9" class="section level3 unnumbered" number="">
<h3>Exercise 9</h3>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="solutions-for-code-challenges.html#cb151-1"></a>k &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb151-2"><a href="solutions-for-code-challenges.html#cb151-2"></a>n &lt;-<span class="st"> </span><span class="dv">13</span></span>
<span id="cb151-3"><a href="solutions-for-code-challenges.html#cb151-3"></a>a &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">pinv</span>(<span class="kw">matrix</span>(<span class="dv">1</span>, <span class="dt">nrow=</span>n, <span class="dt">ncol=</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>k)</span>
<span id="cb151-4"><a href="solutions-for-code-challenges.html#cb151-4"></a>a <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n) <span class="co"># check for zeros</span></span></code></pre></div>
<pre><code>##              [,1]         [,2]         [,3]         [,4]         [,5]
## [1,] 8.673617e-18 6.938894e-18 6.938894e-18 6.938894e-18 6.938894e-18
##              [,6]         [,7]         [,8]         [,9]        [,10]
## [1,] 6.938894e-18 6.938894e-18 6.938894e-18 6.938894e-18 6.938894e-18
##             [,11]        [,12]        [,13]
## [1,] 6.938894e-18 6.938894e-18 6.938894e-18</code></pre>
</div>
<div id="exercise-10" class="section level3 unnumbered" number="">
<h3>Exercise 10</h3>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="solutions-for-code-challenges.html#cb153-1"></a>M &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb153-2"><a href="solutions-for-code-challenges.html#cb153-2"></a>cns &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="fl">1e10</span>, <span class="dt">length.out=</span><span class="dv">30</span>)</span>
<span id="cb153-3"><a href="solutions-for-code-challenges.html#cb153-3"></a>avediffs &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(cns))</span>
<span id="cb153-4"><a href="solutions-for-code-challenges.html#cb153-4"></a></span>
<span id="cb153-5"><a href="solutions-for-code-challenges.html#cb153-5"></a><span class="co"># loop over condition numbers  </span></span>
<span id="cb153-6"><a href="solutions-for-code-challenges.html#cb153-6"></a><span class="cf">for</span>(condi <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(cns)){</span>
<span id="cb153-7"><a href="solutions-for-code-challenges.html#cb153-7"></a>  <span class="co"># create A</span></span>
<span id="cb153-8"><a href="solutions-for-code-challenges.html#cb153-8"></a>  U &lt;-<span class="st"> </span><span class="kw">qr.Q</span>(<span class="kw">qr</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(M<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>M)))</span>
<span id="cb153-9"><a href="solutions-for-code-challenges.html#cb153-9"></a>  V &lt;-<span class="st"> </span><span class="kw">qr.Q</span>(<span class="kw">qr</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(M<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>M)))</span>
<span id="cb153-10"><a href="solutions-for-code-challenges.html#cb153-10"></a>  S &lt;-<span class="st"> </span><span class="kw">diag</span>(cns[condi], <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>M)</span>
<span id="cb153-11"><a href="solutions-for-code-challenges.html#cb153-11"></a>  A &lt;-<span class="st"> </span>U <span class="op">%*%</span><span class="st"> </span>S <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(V) <span class="co"># construct matrix </span></span>
<span id="cb153-12"><a href="solutions-for-code-challenges.html#cb153-12"></a></span>
<span id="cb153-13"><a href="solutions-for-code-challenges.html#cb153-13"></a>  <span class="co"># create B</span></span>
<span id="cb153-14"><a href="solutions-for-code-challenges.html#cb153-14"></a>  U &lt;-<span class="st"> </span><span class="kw">qr.Q</span>(<span class="kw">qr</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(M<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>M)))</span>
<span id="cb153-15"><a href="solutions-for-code-challenges.html#cb153-15"></a>  V &lt;-<span class="st"> </span><span class="kw">qr.Q</span>(<span class="kw">qr</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(M<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>M)))</span>
<span id="cb153-16"><a href="solutions-for-code-challenges.html#cb153-16"></a>  S &lt;-<span class="st"> </span><span class="kw">diag</span>(cns[condi], <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>M)</span>
<span id="cb153-17"><a href="solutions-for-code-challenges.html#cb153-17"></a>  B &lt;-<span class="st"> </span>U <span class="op">%*%</span><span class="st"> </span>S <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(V) <span class="co"># construct matrix </span></span>
<span id="cb153-18"><a href="solutions-for-code-challenges.html#cb153-18"></a>  </span>
<span id="cb153-19"><a href="solutions-for-code-challenges.html#cb153-19"></a>  <span class="co"># GEDs and sort</span></span>
<span id="cb153-20"><a href="solutions-for-code-challenges.html#cb153-20"></a>  l1 &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">eigen</span>(A)<span class="op">$</span>values)</span>
<span id="cb153-21"><a href="solutions-for-code-challenges.html#cb153-21"></a>  l2 &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">eigen</span>(B)<span class="op">$</span>values)</span>
<span id="cb153-22"><a href="solutions-for-code-challenges.html#cb153-22"></a>  </span>
<span id="cb153-23"><a href="solutions-for-code-challenges.html#cb153-23"></a>  avediffs[condi] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(l1<span class="op">-</span>l2))</span>
<span id="cb153-24"><a href="solutions-for-code-challenges.html#cb153-24"></a>}</span>
<span id="cb153-25"><a href="solutions-for-code-challenges.html#cb153-25"></a></span>
<span id="cb153-26"><a href="solutions-for-code-challenges.html#cb153-26"></a><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x=</span>cns, <span class="dt">y=</span>avediffs)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb153-27"><a href="solutions-for-code-challenges.html#cb153-27"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb153-28"><a href="solutions-for-code-challenges.html#cb153-28"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Cond. number&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb153-29"><a href="solutions-for-code-challenges.html#cb153-29"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(Delta, lamda)))</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e16-10-1.png" width="672" />
## Chapter 17
### Exercise 1 {-}</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="solutions-for-code-challenges.html#cb154-1"></a><span class="kw">library</span>(plotly)</span>
<span id="cb154-2"><a href="solutions-for-code-challenges.html#cb154-2"></a></span>
<span id="cb154-3"><a href="solutions-for-code-challenges.html#cb154-3"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">8</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb154-4"><a href="solutions-for-code-challenges.html#cb154-4"></a>vi &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">step=</span><span class="fl">0.1</span>)</span>
<span id="cb154-5"><a href="solutions-for-code-challenges.html#cb154-5"></a>quadform &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="kw">length</span>(vi), <span class="dt">ncol=</span><span class="kw">length</span>(vi))</span>
<span id="cb154-6"><a href="solutions-for-code-challenges.html#cb154-6"></a></span>
<span id="cb154-7"><a href="solutions-for-code-challenges.html#cb154-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(vi)){</span>
<span id="cb154-8"><a href="solutions-for-code-challenges.html#cb154-8"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(vi)){</span>
<span id="cb154-9"><a href="solutions-for-code-challenges.html#cb154-9"></a>    v &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(vi[i], vi[j]), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb154-10"><a href="solutions-for-code-challenges.html#cb154-10"></a>    quadform[i, j] &lt;-<span class="st"> </span><span class="kw">t</span>(v) <span class="op">%*%</span><span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>v <span class="op">/</span><span class="st"> </span>(<span class="kw">t</span>(v) <span class="op">%*%</span><span class="st"> </span>v)</span>
<span id="cb154-11"><a href="solutions-for-code-challenges.html#cb154-11"></a>  }</span>
<span id="cb154-12"><a href="solutions-for-code-challenges.html#cb154-12"></a>}</span>
<span id="cb154-13"><a href="solutions-for-code-challenges.html#cb154-13"></a>  </span>
<span id="cb154-14"><a href="solutions-for-code-challenges.html#cb154-14"></a><span class="kw">plot_ly</span>(<span class="dt">z =</span> quadform, <span class="dt">type =</span> <span class="st">&quot;surface&quot;</span>)</span></code></pre></div>
<p><img src="images/e17-1.png" width="950" /></p>
</div>
<div id="exercise-2-12" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="solutions-for-code-challenges.html#cb155-1"></a>n &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb155-2"><a href="solutions-for-code-challenges.html#cb155-2"></a>nIterations &lt;-<span class="st"> </span><span class="dv">500</span></span>
<span id="cb155-3"><a href="solutions-for-code-challenges.html#cb155-3"></a>defcat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, nIterations)</span>
<span id="cb155-4"><a href="solutions-for-code-challenges.html#cb155-4"></a></span>
<span id="cb155-5"><a href="solutions-for-code-challenges.html#cb155-5"></a><span class="cf">for</span>(iteri <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nIterations){</span>
<span id="cb155-6"><a href="solutions-for-code-challenges.html#cb155-6"></a>  <span class="co"># create matrix</span></span>
<span id="cb155-7"><a href="solutions-for-code-challenges.html#cb155-7"></a>  A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="op">-</span><span class="dv">10</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">size=</span>n<span class="op">^</span><span class="dv">2</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>), <span class="dt">nrow=</span>n, <span class="dt">ncol=</span>n)</span>
<span id="cb155-8"><a href="solutions-for-code-challenges.html#cb155-8"></a>  e &lt;-<span class="st"> </span><span class="kw">eigen</span>(A)<span class="op">$</span>values</span>
<span id="cb155-9"><a href="solutions-for-code-challenges.html#cb155-9"></a>  <span class="cf">while</span> (<span class="kw">is.complex</span>(e)){</span>
<span id="cb155-10"><a href="solutions-for-code-challenges.html#cb155-10"></a>    A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="op">-</span><span class="dv">10</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">size=</span>n<span class="op">^</span><span class="dv">2</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>), <span class="dt">nrow=</span>n, <span class="dt">ncol=</span>n)</span>
<span id="cb155-11"><a href="solutions-for-code-challenges.html#cb155-11"></a>    e &lt;-<span class="st"> </span><span class="kw">eigen</span>(A)<span class="op">$</span>values</span>
<span id="cb155-12"><a href="solutions-for-code-challenges.html#cb155-12"></a>  }</span>
<span id="cb155-13"><a href="solutions-for-code-challenges.html#cb155-13"></a>  </span>
<span id="cb155-14"><a href="solutions-for-code-challenges.html#cb155-14"></a>  <span class="co"># &quot;zero&quot; threshold (from rank)</span></span>
<span id="cb155-15"><a href="solutions-for-code-challenges.html#cb155-15"></a>  t &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span>pracma<span class="op">::</span><span class="kw">eps</span>(<span class="kw">max</span>(<span class="kw">svd</span>(A)<span class="op">$</span>d))</span>
<span id="cb155-16"><a href="solutions-for-code-challenges.html#cb155-16"></a>  </span>
<span id="cb155-17"><a href="solutions-for-code-challenges.html#cb155-17"></a>  <span class="co"># test definiteness</span></span>
<span id="cb155-18"><a href="solutions-for-code-challenges.html#cb155-18"></a>  <span class="cf">if</span> (<span class="kw">all</span>(<span class="kw">sign</span>(e) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)) {</span>
<span id="cb155-19"><a href="solutions-for-code-challenges.html#cb155-19"></a>    defcat[iteri] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># pos. def</span></span>
<span id="cb155-20"><a href="solutions-for-code-challenges.html#cb155-20"></a>  }</span>
<span id="cb155-21"><a href="solutions-for-code-challenges.html#cb155-21"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">all</span>(<span class="kw">sign</span>(e)<span class="op">&gt;-</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>(<span class="kw">sum</span>(<span class="kw">abs</span>(e)<span class="op">&lt;</span>t)<span class="op">&gt;</span><span class="dv">0</span>))){</span>
<span id="cb155-22"><a href="solutions-for-code-challenges.html#cb155-22"></a>    defcat[iteri] &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># pos. semidef</span></span>
<span id="cb155-23"><a href="solutions-for-code-challenges.html#cb155-23"></a>  }</span>
<span id="cb155-24"><a href="solutions-for-code-challenges.html#cb155-24"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">all</span>(<span class="kw">sign</span>(e)<span class="op">&lt;</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>(<span class="kw">sum</span>(<span class="kw">abs</span>(e)<span class="op">&lt;</span>t)<span class="op">&gt;</span><span class="dv">0</span>))){</span>
<span id="cb155-25"><a href="solutions-for-code-challenges.html#cb155-25"></a>    defcat[iteri] &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co"># neg. semidef</span></span>
<span id="cb155-26"><a href="solutions-for-code-challenges.html#cb155-26"></a>  }</span>
<span id="cb155-27"><a href="solutions-for-code-challenges.html#cb155-27"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">all</span>(<span class="kw">sign</span>(e) <span class="op">==</span><span class="st"> </span><span class="dv">-1</span>)) {</span>
<span id="cb155-28"><a href="solutions-for-code-challenges.html#cb155-28"></a>    defcat[iteri] &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co"># neg. def</span></span>
<span id="cb155-29"><a href="solutions-for-code-challenges.html#cb155-29"></a>  }</span>
<span id="cb155-30"><a href="solutions-for-code-challenges.html#cb155-30"></a>  <span class="cf">else</span> {</span>
<span id="cb155-31"><a href="solutions-for-code-challenges.html#cb155-31"></a>    defcat[iteri] &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co"># indefinite</span></span>
<span id="cb155-32"><a href="solutions-for-code-challenges.html#cb155-32"></a>  }</span>
<span id="cb155-33"><a href="solutions-for-code-challenges.html#cb155-33"></a>}</span>
<span id="cb155-34"><a href="solutions-for-code-challenges.html#cb155-34"></a></span>
<span id="cb155-35"><a href="solutions-for-code-challenges.html#cb155-35"></a><span class="co"># print out summary</span></span>
<span id="cb155-36"><a href="solutions-for-code-challenges.html#cb155-36"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb155-37"><a href="solutions-for-code-challenges.html#cb155-37"></a>{</span>
<span id="cb155-38"><a href="solutions-for-code-challenges.html#cb155-38"></a>  <span class="kw">print</span>(<span class="kw">sprintf</span>(<span class="st">&quot;cat %d: %d&quot;</span>, i, <span class="kw">sum</span>(defcat <span class="op">==</span><span class="st"> </span>i)))</span>
<span id="cb155-39"><a href="solutions-for-code-challenges.html#cb155-39"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;cat 1: 1&quot;
## [1] &quot;cat 2: 0&quot;
## [1] &quot;cat 3: 498&quot;
## [1] &quot;cat 4: 0&quot;
## [1] &quot;cat 5: 1&quot;</code></pre>
</div>
</div>
<div id="chapter-18" class="section level2 unnumbered" number="">
<h2>Chapter 18</h2>
<div id="exercise-1-11" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="solutions-for-code-challenges.html#cb157-1"></a>n &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb157-2"><a href="solutions-for-code-challenges.html#cb157-2"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span><span class="dv">4</span>), <span class="dt">nrow=</span>n, <span class="dt">ncol=</span><span class="dv">4</span>) <span class="co"># data</span></span>
<span id="cb157-3"><a href="solutions-for-code-challenges.html#cb157-3"></a>X &lt;-<span class="st"> </span><span class="kw">apply</span>(X, <span class="dt">MARGIN=</span><span class="dv">2</span>, <span class="dt">FUN=</span>scale, <span class="dt">scale=</span><span class="ot">FALSE</span>) <span class="co"># mean-center</span></span>
<span id="cb157-4"><a href="solutions-for-code-challenges.html#cb157-4"></a>covM &lt;-<span class="st"> </span><span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X <span class="op">/</span><span class="st"> </span>(n<span class="dv">-1</span>) <span class="co"># covariance</span></span>
<span id="cb157-5"><a href="solutions-for-code-challenges.html#cb157-5"></a>stdM &lt;-<span class="st"> </span><span class="kw">solve</span>(<span class="kw">diag</span>(<span class="kw">apply</span>(X, <span class="dt">MARGIN=</span><span class="dv">2</span>, <span class="dt">FUN=</span>sd))) <span class="co"># stdevs</span></span>
<span id="cb157-6"><a href="solutions-for-code-challenges.html#cb157-6"></a>corM &lt;-<span class="st"> </span>stdM <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>stdM <span class="op">/</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="co"># R</span></span>
<span id="cb157-7"><a href="solutions-for-code-challenges.html#cb157-7"></a></span>
<span id="cb157-8"><a href="solutions-for-code-challenges.html#cb157-8"></a><span class="co"># compare ours against R&#39;s</span></span>
<span id="cb157-9"><a href="solutions-for-code-challenges.html#cb157-9"></a><span class="kw">print</span>(<span class="kw">round</span>(covM <span class="op">-</span><span class="st"> </span><span class="kw">cov</span>(X), <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    0    0    0    0
## [2,]    0    0    0    0
## [3,]    0    0    0    0
## [4,]    0    0    0    0</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="solutions-for-code-challenges.html#cb159-1"></a><span class="kw">print</span>(<span class="kw">round</span>(corM <span class="op">-</span><span class="st"> </span><span class="kw">cor</span>(X), <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    0    0    0    0
## [2,]    0    0    0    0
## [3,]    0    0    0    0
## [4,]    0    0    0    0</code></pre>
</div>
</div>
<div id="chapter-19" class="section level2 unnumbered" number="">
<h2>Chapter 19</h2>
<div id="exercise-1-12" class="section level3 unnumbered" number="">
<h3>Exercise 1</h3>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="solutions-for-code-challenges.html#cb161-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb161-2"><a href="solutions-for-code-challenges.html#cb161-2"></a></span>
<span id="cb161-3"><a href="solutions-for-code-challenges.html#cb161-3"></a><span class="co"># create data</span></span>
<span id="cb161-4"><a href="solutions-for-code-challenges.html#cb161-4"></a>N &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb161-5"><a href="solutions-for-code-challenges.html#cb161-5"></a>h &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n=</span>N, <span class="dt">mean =</span> <span class="kw">seq</span>(<span class="dv">150</span>, <span class="dv">190</span>, <span class="dt">length.out =</span> N), <span class="dt">sd=</span><span class="dv">5</span>)</span>
<span id="cb161-6"><a href="solutions-for-code-challenges.html#cb161-6"></a>w &lt;-<span class="st"> </span>h <span class="op">*</span><span class="st"> </span><span class="fl">.7</span> <span class="op">-</span><span class="st"> </span><span class="dv">50</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">10</span>)</span>
<span id="cb161-7"><a href="solutions-for-code-challenges.html#cb161-7"></a></span>
<span id="cb161-8"><a href="solutions-for-code-challenges.html#cb161-8"></a><span class="co"># covariance</span></span>
<span id="cb161-9"><a href="solutions-for-code-challenges.html#cb161-9"></a>X &lt;-<span class="st"> </span><span class="kw">cbind</span>(h, w)</span>
<span id="cb161-10"><a href="solutions-for-code-challenges.html#cb161-10"></a>X &lt;-<span class="st"> </span><span class="kw">apply</span>(X, <span class="dt">MARGIN=</span><span class="dv">2</span>, scale, <span class="dt">scale=</span><span class="ot">FALSE</span>)</span>
<span id="cb161-11"><a href="solutions-for-code-challenges.html#cb161-11"></a>C &lt;-<span class="st"> </span><span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X <span class="op">/</span><span class="st"> </span>(<span class="kw">length</span>(h) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb161-12"><a href="solutions-for-code-challenges.html#cb161-12"></a></span>
<span id="cb161-13"><a href="solutions-for-code-challenges.html#cb161-13"></a><span class="co"># PCA</span></span>
<span id="cb161-14"><a href="solutions-for-code-challenges.html#cb161-14"></a>eigC &lt;-<span class="st"> </span><span class="kw">eigen</span>(C)</span>
<span id="cb161-15"><a href="solutions-for-code-challenges.html#cb161-15"></a></span>
<span id="cb161-16"><a href="solutions-for-code-challenges.html#cb161-16"></a><span class="co"># sorting below is redundant in R, as values and vectors are presorted</span></span>
<span id="cb161-17"><a href="solutions-for-code-challenges.html#cb161-17"></a>i &lt;-<span class="st"> </span><span class="kw">order</span>(eigC<span class="op">$</span>values, <span class="dt">decreasing=</span><span class="ot">TRUE</span>) </span>
<span id="cb161-18"><a href="solutions-for-code-challenges.html#cb161-18"></a>V &lt;-<span class="st"> </span>eigC<span class="op">$</span>vectors[, i]</span>
<span id="cb161-19"><a href="solutions-for-code-challenges.html#cb161-19"></a>eigvals &lt;-<span class="st"> </span>eigC<span class="op">$</span>values[i]</span>
<span id="cb161-20"><a href="solutions-for-code-challenges.html#cb161-20"></a>eigvals &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>eigvals <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(eigvals)</span>
<span id="cb161-21"><a href="solutions-for-code-challenges.html#cb161-21"></a>scores &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>V <span class="co"># not used, but useful code</span></span>
<span id="cb161-22"><a href="solutions-for-code-challenges.html#cb161-22"></a></span>
<span id="cb161-23"><a href="solutions-for-code-challenges.html#cb161-23"></a><span class="co"># plot data with PCs</span></span>
<span id="cb161-24"><a href="solutions-for-code-challenges.html#cb161-24"></a><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x =</span> X[, <span class="dv">1</span>], <span class="dt">y =</span> X[, <span class="dv">2</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb161-25"><a href="solutions-for-code-challenges.html#cb161-25"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb161-26"><a href="solutions-for-code-challenges.html#cb161-26"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">0</span>, <span class="dt">y=</span><span class="dv">0</span>, <span class="dt">xend=</span>V[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">*</span><span class="st"> </span><span class="dv">45</span>, <span class="dt">yend=</span>V[<span class="dv">2</span>, <span class="dv">1</span>] <span class="op">*</span><span class="st"> </span><span class="dv">45</span>), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb161-27"><a href="solutions-for-code-challenges.html#cb161-27"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">0</span>, <span class="dt">y=</span><span class="dv">0</span>, <span class="dt">xend=</span>V[<span class="dv">1</span>, <span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">25</span>, <span class="dt">yend=</span>V[<span class="dv">2</span>, <span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">25</span>), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb161-28"><a href="solutions-for-code-challenges.html#cb161-28"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Height&quot;</span>, <span class="dt">limits=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb161-29"><a href="solutions-for-code-challenges.html#cb161-29"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Weight&quot;</span>, <span class="dt">limits=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb161-30"><a href="solutions-for-code-challenges.html#cb161-30"></a><span class="st">  </span><span class="kw">coord_equal</span>()</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e19-1-1.png" width="672" /></p>
</div>
<div id="exercise-2-13" class="section level3 unnumbered" number="">
<h3>Exercise 2</h3>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="solutions-for-code-challenges.html#cb162-1"></a>X &lt;-<span class="st"> </span><span class="kw">apply</span>(X, <span class="dt">MARGIN=</span><span class="dv">2</span>, scale, <span class="dt">scale=</span><span class="ot">FALSE</span>)</span>
<span id="cb162-2"><a href="solutions-for-code-challenges.html#cb162-2"></a>svdX &lt;-<span class="st"> </span><span class="kw">svd</span>(X, <span class="dt">nu=</span><span class="kw">nrow</span>(X), <span class="dt">nv=</span><span class="kw">ncol</span>(X))</span>
<span id="cb162-3"><a href="solutions-for-code-challenges.html#cb162-3"></a>scores &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>svdX<span class="op">$</span>v</span>
<span id="cb162-4"><a href="solutions-for-code-challenges.html#cb162-4"></a>s &lt;-<span class="st"> </span><span class="kw">diag</span>(svdX<span class="op">$</span>d)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="kw">nrow</span>(X) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb162-5"><a href="solutions-for-code-challenges.html#cb162-5"></a>s &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>s <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(s) <span class="co"># s == eigvals</span></span></code></pre></div>
</div>
<div id="exercise-3-6" class="section level3 unnumbered" number="">
<h3>Exercise 3</h3>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="solutions-for-code-challenges.html#cb163-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb163-2"><a href="solutions-for-code-challenges.html#cb163-2"></a></span>
<span id="cb163-3"><a href="solutions-for-code-challenges.html#cb163-3"></a><span class="co"># create data</span></span>
<span id="cb163-4"><a href="solutions-for-code-challenges.html#cb163-4"></a>N &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb163-5"><a href="solutions-for-code-challenges.html#cb163-5"></a>h &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n=</span>N, <span class="dt">mean =</span> <span class="kw">seq</span>(<span class="dv">150</span>, <span class="dv">190</span>, <span class="dt">length.out =</span> N), <span class="dt">sd=</span><span class="dv">5</span>)</span>
<span id="cb163-6"><a href="solutions-for-code-challenges.html#cb163-6"></a>w &lt;-<span class="st"> </span>h <span class="op">*</span><span class="st"> </span><span class="fl">.7</span> <span class="op">-</span><span class="st"> </span><span class="dv">50</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">10</span>)</span>
<span id="cb163-7"><a href="solutions-for-code-challenges.html#cb163-7"></a></span>
<span id="cb163-8"><a href="solutions-for-code-challenges.html#cb163-8"></a><span class="co"># covariance</span></span>
<span id="cb163-9"><a href="solutions-for-code-challenges.html#cb163-9"></a>X &lt;-<span class="st"> </span><span class="kw">cbind</span>(h, w)</span>
<span id="cb163-10"><a href="solutions-for-code-challenges.html#cb163-10"></a>C &lt;-<span class="st"> </span><span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X <span class="op">/</span><span class="st"> </span>(<span class="kw">length</span>(h) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb163-11"><a href="solutions-for-code-challenges.html#cb163-11"></a></span>
<span id="cb163-12"><a href="solutions-for-code-challenges.html#cb163-12"></a><span class="co"># PCA</span></span>
<span id="cb163-13"><a href="solutions-for-code-challenges.html#cb163-13"></a>eigC &lt;-<span class="st"> </span><span class="kw">eigen</span>(C)</span>
<span id="cb163-14"><a href="solutions-for-code-challenges.html#cb163-14"></a></span>
<span id="cb163-15"><a href="solutions-for-code-challenges.html#cb163-15"></a><span class="co"># sorting below is redundant in R, as values and vectors are presorted</span></span>
<span id="cb163-16"><a href="solutions-for-code-challenges.html#cb163-16"></a>i &lt;-<span class="st"> </span><span class="kw">order</span>(eigC<span class="op">$</span>values, <span class="dt">decreasing=</span><span class="ot">TRUE</span>) </span>
<span id="cb163-17"><a href="solutions-for-code-challenges.html#cb163-17"></a>V &lt;-<span class="st"> </span>eigC<span class="op">$</span>vectors[, i]</span>
<span id="cb163-18"><a href="solutions-for-code-challenges.html#cb163-18"></a>eigvals &lt;-<span class="st"> </span>eigC<span class="op">$</span>values[i]</span>
<span id="cb163-19"><a href="solutions-for-code-challenges.html#cb163-19"></a>eigvals &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>eigvals <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(eigvals)</span>
<span id="cb163-20"><a href="solutions-for-code-challenges.html#cb163-20"></a>scores &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>V <span class="co"># not used, but useful code</span></span>
<span id="cb163-21"><a href="solutions-for-code-challenges.html#cb163-21"></a></span>
<span id="cb163-22"><a href="solutions-for-code-challenges.html#cb163-22"></a><span class="co"># now we center the data</span></span>
<span id="cb163-23"><a href="solutions-for-code-challenges.html#cb163-23"></a>X &lt;-<span class="st"> </span><span class="kw">apply</span>(X, <span class="dt">MARGIN=</span><span class="dv">2</span>, scale, <span class="dt">scale=</span><span class="ot">FALSE</span>)</span>
<span id="cb163-24"><a href="solutions-for-code-challenges.html#cb163-24"></a></span>
<span id="cb163-25"><a href="solutions-for-code-challenges.html#cb163-25"></a><span class="co"># plot data with PCs</span></span>
<span id="cb163-26"><a href="solutions-for-code-challenges.html#cb163-26"></a><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x =</span> X[, <span class="dv">1</span>], <span class="dt">y =</span> X[, <span class="dv">2</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb163-27"><a href="solutions-for-code-challenges.html#cb163-27"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb163-28"><a href="solutions-for-code-challenges.html#cb163-28"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">0</span>, <span class="dt">y=</span><span class="dv">0</span>, <span class="dt">xend=</span>V[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">*</span><span class="st"> </span><span class="dv">45</span>, <span class="dt">yend=</span>V[<span class="dv">2</span>, <span class="dv">1</span>] <span class="op">*</span><span class="st"> </span><span class="dv">45</span>), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb163-29"><a href="solutions-for-code-challenges.html#cb163-29"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">0</span>, <span class="dt">y=</span><span class="dv">0</span>, <span class="dt">xend=</span>V[<span class="dv">1</span>, <span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">25</span>, <span class="dt">yend=</span>V[<span class="dv">2</span>, <span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">25</span>), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb163-30"><a href="solutions-for-code-challenges.html#cb163-30"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Height&quot;</span>, <span class="dt">limits=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb163-31"><a href="solutions-for-code-challenges.html#cb163-31"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Weight&quot;</span>, <span class="dt">limits=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb163-32"><a href="solutions-for-code-challenges.html#cb163-32"></a><span class="st">  </span><span class="kw">coord_equal</span>()</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/e19-3-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="code.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="function-references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cohen-linear-algebra.pdf", "cohen-linear-algebra.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
