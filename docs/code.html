<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Code | R-version of the code for “Linear Algebra: Theory, Intuition, Code” by Mike X Cohen</title>
  <meta name="description" content="R-version of the code for Linear Algebra: Theory, Intuition, Code by Mike X Cohen" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Code | R-version of the code for “Linear Algebra: Theory, Intuition, Code” by Mike X Cohen" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="R-version of the code for Linear Algebra: Theory, Intuition, Code by Mike X Cohen" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Code | R-version of the code for “Linear Algebra: Theory, Intuition, Code” by Mike X Cohen" />
  
  <meta name="twitter:description" content="R-version of the code for Linear Algebra: Theory, Intuition, Code by Mike X Cohen" />
  

<meta name="author" content="Alexander (Sasha) Pastukhov" />


<meta name="date" content="2021-03-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="solutions-for-code-challenges.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R-code for Linear Algebra by Mike X Cohen</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#libraries-the-code-relies-upon"><i class="fa fa-check"></i>Libraries the code relies upon</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html"><i class="fa fa-check"></i>Code</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-2"><i class="fa fa-check"></i>Chapter 2</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-2.12.2"><i class="fa fa-check"></i>Code block 2.1/2.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-2.32.4"><i class="fa fa-check"></i>Code block 2.3/2.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-2.52.6"><i class="fa fa-check"></i>Code block 2.5/2.6</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-2.72.8"><i class="fa fa-check"></i>Code block 2.7/2.8</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-2.92.10"><i class="fa fa-check"></i>Code block 2.9/2.10</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-3"><i class="fa fa-check"></i>Chapter 3</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-3.13.2"><i class="fa fa-check"></i>Code block 3.1/3.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-3.33.4"><i class="fa fa-check"></i>Code block 3.3/3.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-3.53.6"><i class="fa fa-check"></i>Code block 3.5/3.6</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-3.73.8"><i class="fa fa-check"></i>Code block 3.7/3.8</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-3.93.10"><i class="fa fa-check"></i>Code block 3.9/3.10</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-5"><i class="fa fa-check"></i>Chapter 5</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.15.2"><i class="fa fa-check"></i>Code block 5.1/5.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.35.4"><i class="fa fa-check"></i>Code block 5.3/5.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.55.6"><i class="fa fa-check"></i>Code block 5.5/5.6</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.75.8"><i class="fa fa-check"></i>Code block 5.7/5.8</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.95.10"><i class="fa fa-check"></i>Code block 5.9/5.10</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.115.12"><i class="fa fa-check"></i>Code block 5.11/5.12</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.135.14"><i class="fa fa-check"></i>Code block 5.13/5.14</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-5.155.16"><i class="fa fa-check"></i>Code block 5.15/5.16</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-6"><i class="fa fa-check"></i>Chapter 6</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-6.16.2"><i class="fa fa-check"></i>Code block 6.1/6.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-6.36.4"><i class="fa fa-check"></i>Code block 6.3/6.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-6.56.6"><i class="fa fa-check"></i>Code block 6.5/6.6</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-6.76.8"><i class="fa fa-check"></i>Code block 6.7/6.8</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-6.96.10"><i class="fa fa-check"></i>Code block 6.9/6.10</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-6.116.12"><i class="fa fa-check"></i>Code block 6.11/6.12</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-7"><i class="fa fa-check"></i>Chapter 7</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-7.17.2"><i class="fa fa-check"></i>Code block 7.1/7.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-7.37.4"><i class="fa fa-check"></i>Code block 7.3/7.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-7.57.6"><i class="fa fa-check"></i>Code block 7.5/7.6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-8"><i class="fa fa-check"></i>Chapter 8</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-8.18.2"><i class="fa fa-check"></i>Code block 8.1/8.2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-9"><i class="fa fa-check"></i>Chapter 9</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-9.19.2"><i class="fa fa-check"></i>Code block 9.1/9.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-9.39.4"><i class="fa fa-check"></i>Code block 9.3/9.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-9.59.6"><i class="fa fa-check"></i>Code block 9.5/9.6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-10"><i class="fa fa-check"></i>Chapter 10</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-10.110.2"><i class="fa fa-check"></i>Code block 10.1/10.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-10.310.4"><i class="fa fa-check"></i>Code block 10.3/10.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-11"><i class="fa fa-check"></i>Chapter 11</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-11.111.2"><i class="fa fa-check"></i>Code block 11.1/11.2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-12"><i class="fa fa-check"></i>Chapter 12</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-12.112.2"><i class="fa fa-check"></i>Code block 12.1/12.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-12.312.4"><i class="fa fa-check"></i>Code block 12.3/12.4</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-12.512.6"><i class="fa fa-check"></i>Code block 12.5/12.6</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-12.712.8"><i class="fa fa-check"></i>Code block 12.7/12.8</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-13"><i class="fa fa-check"></i>Chapter 13</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-13.113.2"><i class="fa fa-check"></i>Code block 13.1/13.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-13.313.4"><i class="fa fa-check"></i>Code block 13.3/13.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-15"><i class="fa fa-check"></i>Chapter 15</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-15.115.2"><i class="fa fa-check"></i>Code block 15.1/15.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-15.315.4"><i class="fa fa-check"></i>Code block 15.3/15.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-16"><i class="fa fa-check"></i>Chapter 16</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-16.116.2"><i class="fa fa-check"></i>Code block 16.1/16.2</a></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-16.316.4"><i class="fa fa-check"></i>Code block 16.3/16.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#chapter-17"><i class="fa fa-check"></i>Chapter 17</a>
<ul>
<li class="chapter" data-level="" data-path="code.html"><a href="code.html#code-block-17.117.2"><i class="fa fa-check"></i>Code block 17.1/17.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html"><i class="fa fa-check"></i>Solutions for code challenges</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-2-1"><i class="fa fa-check"></i>Chapter 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-3-1"><i class="fa fa-check"></i>Chapter 3</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-5-1"><i class="fa fa-check"></i>Chapter 5</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-1"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3-1"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-6-1"><i class="fa fa-check"></i>Chapter 6</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-2"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3-2"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-7-1"><i class="fa fa-check"></i>Chapter 7</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-3"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-3"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-8-1"><i class="fa fa-check"></i>Chapter 8</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-4"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-4"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-9-1"><i class="fa fa-check"></i>Chapter 9</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-5"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-5"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-10-1"><i class="fa fa-check"></i>Chapter 10</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-6"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-6"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-11-1"><i class="fa fa-check"></i>Chapter 11</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-7"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-7"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-12-1"><i class="fa fa-check"></i>Chapter 12</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-8"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-8"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-13-1"><i class="fa fa-check"></i>Chapter 13</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-9"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-14"><i class="fa fa-check"></i>Chapter 14</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-4-1"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-5"><i class="fa fa-check"></i>Exercise 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-15-1"><i class="fa fa-check"></i>Chapter 15</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-9"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-10"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3-4"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-16-1"><i class="fa fa-check"></i>Chapter 16</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-10"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-11"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3-5"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-4-2"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-5-1"><i class="fa fa-check"></i>Exercise 5</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-6"><i class="fa fa-check"></i>Exercise 6</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-7"><i class="fa fa-check"></i>Exercise 7</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-8"><i class="fa fa-check"></i>Exercise 8</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-9"><i class="fa fa-check"></i>Exercise 9</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-10"><i class="fa fa-check"></i>Exercise 10</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-12"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-18"><i class="fa fa-check"></i>Chapter 18</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-11"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#chapter-19"><i class="fa fa-check"></i>Chapter 19</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-1-12"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-2-13"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="solutions-for-code-challenges.html"><a href="solutions-for-code-challenges.html#exercise-3-6"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html"><i class="fa fa-check"></i>Function references</a>
<ul>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#c"><i class="fa fa-check"></i>C</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#d"><i class="fa fa-check"></i>D</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#e"><i class="fa fa-check"></i>E</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#g"><i class="fa fa-check"></i>G</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#h"><i class="fa fa-check"></i>H</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#i"><i class="fa fa-check"></i>I</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#l"><i class="fa fa-check"></i>L</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#m"><i class="fa fa-check"></i>M</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#n"><i class="fa fa-check"></i>N</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#o"><i class="fa fa-check"></i>O</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#p"><i class="fa fa-check"></i>P</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#q"><i class="fa fa-check"></i>Q</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#s"><i class="fa fa-check"></i>S</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#t"><i class="fa fa-check"></i>T</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#u"><i class="fa fa-check"></i>U</a></li>
<li class="chapter" data-level="" data-path="function-references.html"><a href="function-references.html#v"><i class="fa fa-check"></i>V</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-version of the code for “Linear Algebra: Theory, Intuition, Code” by <em>Mike X Cohen</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="code" class="section level1 unnumbered" number="">
<h1>Code</h1>
<div id="chapter-2" class="section level2 unnumbered" number="">
<h2>Chapter 2</h2>
<div id="code-block-2.12.2" class="section level3 unnumbered" number="">
<h3>Code block 2.1/2.2</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="code.html#cb1-1"></a>aScalar &lt;-<span class="st"> </span><span class="dv">4</span></span></code></pre></div>
</div>
<div id="code-block-2.32.4" class="section level3 unnumbered" number="">
<h3>Code block 2.3/2.4</h3>
<p>This is a <a href="https://ggplot2.tidyverse.org/">ggplot2</a> rather than base R version. But <em>ggplot2</em> figures do look so much better.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="code.html#cb2-1"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.0.4</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="code.html#cb4-1"></a>v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">-1</span>)</span>
<span id="cb4-2"><a href="code.html#cb4-2"></a><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, v[<span class="dv">1</span>]), <span class="dt">y=</span><span class="kw">c</span>(<span class="dv">0</span>, v[<span class="dv">2</span>])))  <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-3"><a href="code.html#cb4-3"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-4"><a href="code.html#cb4-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>v[<span class="dv">1</span>], <span class="dt">y=</span>v[<span class="dv">2</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-5"><a href="code.html#cb4-5"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="kw">expression</span>(<span class="kw">paste</span>(X[<span class="dv">1</span>], <span class="st">&quot; dim.&quot;</span>)), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-6"><a href="code.html#cb4-6"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="kw">expression</span>(<span class="kw">paste</span>(X[<span class="dv">2</span>], <span class="st">&quot; dim.&quot;</span>)), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-7"><a href="code.html#cb4-7"></a><span class="st">  </span><span class="kw">coord_equal</span>()</span></code></pre></div>
<p><img src="cohen-linear-algebra_files/figure-html/cb02-3/4-1.png" width="672" /></p>
</div>
<div id="code-block-2.52.6" class="section level3 unnumbered" number="">
<h3>Code block 2.5/2.6</h3>
<p>In R <em>atomic</em> vectors are created via <code>c()</code> function but, technically, they are neither column, nor row vectors. <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/matmult.html">Matrix multiplication manual</a> states that it “<em>multiplies two matrices, if they are conformable. If one argument is a vector, it will be promoted to either a row or column matrix to make the two arguments conformable. If both are vectors of the same length, it will return the inner product (as a matrix).</em>” At the same time, <em>transposing</em> an atomic vector <code>t(c(...))</code> transforms it into a single row matrix, thus a row vector, hinting that deep down an outcome of <code>c()</code> is a column vector.</p>
<p>To avoid ambiguity, I will use single row and single column matrices for, respectively, row and column vectors.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="code.html#cb5-1"></a>v1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">7</span>), <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="co"># row vector</span></span>
<span id="cb5-2"><a href="code.html#cb5-2"></a>v2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">7</span>), <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="co"># column vector</span></span>
<span id="cb5-3"><a href="code.html#cb5-3"></a>v3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">7</span>))           <span class="co"># also a column vector</span></span></code></pre></div>
</div>
<div id="code-block-2.72.8" class="section level3 unnumbered" number="">
<h3>Code block 2.7/2.8</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="code.html#cb6-1"></a>v1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">7</span>), <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="co"># row vector</span></span>
<span id="cb6-2"><a href="code.html#cb6-2"></a>v1a &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">7</span>))               <span class="co"># also a row vector</span></span>
<span id="cb6-3"><a href="code.html#cb6-3"></a>v2 &lt;-<span class="st"> </span><span class="kw">t</span>(v1)                           <span class="co"># column vector</span></span></code></pre></div>
</div>
<div id="code-block-2.92.10" class="section level3 unnumbered" number="">
<h3>Code block 2.9/2.10</h3>
<p>For this example, you can also use atomic vectors directly without turning them into a column vector / single column matrix.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="code.html#cb7-1"></a>v1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb7-2"><a href="code.html#cb7-2"></a>v2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb7-3"><a href="code.html#cb7-3"></a>v3 &lt;-<span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span>v1  <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>v2</span></code></pre></div>
</div>
</div>
<div id="chapter-3" class="section level2 unnumbered" number="">
<h2>Chapter 3</h2>
<div id="code-block-3.13.2" class="section level3 unnumbered" number="">
<h3>Code block 3.1/3.2</h3>
<p>There is no <em>explicit</em> dot product function in base R but there are multiple implementations in various libraries such as <a href="https://github.com/cran/pracma">pracma</a> used here.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="code.html#cb8-1"></a>v1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb8-2"><a href="code.html#cb8-2"></a>v2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb8-3"><a href="code.html#cb8-3"></a>dp &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">dot</span>(v1, v2)</span></code></pre></div>
<p>However, a matrix multiplication of <em>atomic</em> vectors (we can convert a matrix back to an atomic vector via <code>c()</code> or <code>as.vector()</code>) gives us the dot product (well, the <em>inner</em> product, which is why the result is a 1-by-1 matrix).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="code.html#cb9-1"></a>dp &lt;-<span class="st"> </span><span class="kw">c</span>(v1) <span class="op">%*%</span><span class="st"> </span><span class="kw">as.vector</span>(v2)</span></code></pre></div>
</div>
<div id="code-block-3.33.4" class="section level3 unnumbered" number="">
<h3>Code block 3.3/3.4</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="code.html#cb10-1"></a>l1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb10-2"><a href="code.html#cb10-2"></a>l2 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb10-3"><a href="code.html#cb10-3"></a>l3 &lt;-<span class="st"> </span><span class="dv">-3</span></span>
<span id="cb10-4"><a href="code.html#cb10-4"></a>v1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">1</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb10-5"><a href="code.html#cb10-5"></a>v2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">-4</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb10-6"><a href="code.html#cb10-6"></a>v3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb10-7"><a href="code.html#cb10-7"></a>l1 <span class="op">*</span><span class="st"> </span>v1 <span class="op">+</span><span class="st"> </span>l2 <span class="op">*</span><span class="st"> </span>v2 <span class="op">+</span><span class="st"> </span>l3 <span class="op">*</span><span class="st"> </span>v3</span></code></pre></div>
<pre><code>##      [,1]
## [1,]   -7
## [2,]   -4
## [3,]  -13</code></pre>
</div>
<div id="code-block-3.53.6" class="section level3 unnumbered" number="">
<h3>Code block 3.5/3.6</h3>
<p>To compute the outer product, we must use atomic vectors, thus I’ve skipped the whole creating-column-vector-as-a-matrix thing.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="code.html#cb12-1"></a>v1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb12-2"><a href="code.html#cb12-2"></a>v2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb12-3"><a href="code.html#cb12-3"></a>op &lt;-<span class="st"> </span><span class="kw">outer</span>(v1, v2)</span>
<span id="cb12-4"><a href="code.html#cb12-4"></a>op &lt;-<span class="st"> </span>v1 <span class="op">%o%</span><span class="st"> </span>v2 <span class="co"># alternative call as operation</span></span></code></pre></div>
<p>Alternatively, if we do start with vectors as single column matrices…</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="code.html#cb13-1"></a>v1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb13-2"><a href="code.html#cb13-2"></a>v2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb13-3"><a href="code.html#cb13-3"></a>op &lt;-<span class="st"> </span><span class="kw">outer</span>(<span class="kw">c</span>(v1), <span class="kw">c</span>(v2))</span>
<span id="cb13-4"><a href="code.html#cb13-4"></a>op &lt;-<span class="st"> </span><span class="kw">c</span>(v1) <span class="op">%o%</span><span class="st"> </span><span class="kw">c</span>(v2) <span class="co"># alternative call as operation</span></span></code></pre></div>
</div>
<div id="code-block-3.73.8" class="section level3 unnumbered" number="">
<h3>Code block 3.7/3.8</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="code.html#cb14-1"></a>v1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb14-2"><a href="code.html#cb14-2"></a>v2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb14-3"><a href="code.html#cb14-3"></a>v3 &lt;-<span class="st"> </span>v1 <span class="op">*</span><span class="st"> </span>v2</span></code></pre></div>
</div>
<div id="code-block-3.93.10" class="section level3 unnumbered" number="">
<h3>Code block 3.9/3.10</h3>
<p>Please note that you need to explicitly specify the 2-norm via <code>type="2"</code>, as the <em>one norm</em> is used by default.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="code.html#cb15-1"></a>v &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb15-2"><a href="code.html#cb15-2"></a>vMag &lt;-<span class="st"> </span><span class="kw">norm</span>(v, <span class="dt">type=</span><span class="st">&quot;2&quot;</span>)</span>
<span id="cb15-3"><a href="code.html#cb15-3"></a>v_unit &lt;-<span class="st"> </span>v <span class="op">/</span><span class="st"> </span>vMag</span></code></pre></div>
</div>
</div>
<div id="chapter-5" class="section level2 unnumbered" number="">
<h2>Chapter 5</h2>
<div id="code-block-5.15.2" class="section level3 unnumbered" number="">
<h3>Code block 5.1/5.2</h3>
<p>There is only one way to transpose a matrix in R: via function <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/t.html">t()</a>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="code.html#cb16-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">2</span><span class="op">*</span><span class="dv">5</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb16-2"><a href="code.html#cb16-2"></a>At1 &lt;-<span class="st"> </span><span class="kw">t</span>(A)</span></code></pre></div>
</div>
<div id="code-block-5.35.4" class="section level3 unnumbered" number="">
<h3>Code block 5.3/5.4</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="code.html#cb17-1"></a>I &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">4</span>)</span>
<span id="cb17-2"><a href="code.html#cb17-2"></a>O &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>, <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">1</span>) <span class="co"># or rep(1, times=4) to create an atomic vector</span></span>
<span id="cb17-3"><a href="code.html#cb17-3"></a>Z &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span></code></pre></div>
</div>
<div id="code-block-5.55.6" class="section level3 unnumbered" number="">
<h3>Code block 5.5/5.6</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="code.html#cb18-1"></a>D &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>))  <span class="co"># diagonal matrix</span></span>
<span id="cb18-2"><a href="code.html#cb18-2"></a>R &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n =</span> <span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb18-3"><a href="code.html#cb18-3"></a>d &lt;-<span class="st"> </span><span class="kw">diag</span>(R) <span class="co"># diagonal elements</span></span></code></pre></div>
</div>
<div id="code-block-5.75.8" class="section level3 unnumbered" number="">
<h3>Code block 5.7/5.8</h3>
<p>In r <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/cbind.html">cbind()</a> and <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/cbind.html">rbind()</a> concatenate, respectively, by column and row.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="code.html#cb19-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n =</span> <span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb19-2"><a href="code.html#cb19-2"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n =</span> <span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb19-3"><a href="code.html#cb19-3"></a>AB &lt;-<span class="st"> </span><span class="kw">cbind</span>(A, B)</span></code></pre></div>
</div>
<div id="code-block-5.95.10" class="section level3 unnumbered" number="">
<h3>Code block 5.9/5.10</h3>
<p>There are two ways to compute lower and upper triangular parts of a matrix. First, to use <code>tril()</code> and <code>triu()</code> function from <em>pracma</em> library.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="code.html#cb20-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n =</span> <span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>), <span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb20-2"><a href="code.html#cb20-2"></a>L &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">tril</span>(A)</span>
<span id="cb20-3"><a href="code.html#cb20-3"></a>U &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">triu</span>(A)</span></code></pre></div>
<p>Alternatively, you can use base R functions <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/lower.tri.html">lower.tri()</a> and <code>upper.tri()</code> that give you a matrix of the same size with <em>logical</em> values indicating whether an element belongs to, respectively, lower or upper triangle. Note that by default, the diagonal <em>is not</em> included!</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="code.html#cb21-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n =</span> <span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>), <span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb21-2"><a href="code.html#cb21-2"></a></span>
<span id="cb21-3"><a href="code.html#cb21-3"></a>L &lt;-<span class="st"> </span>A</span>
<span id="cb21-4"><a href="code.html#cb21-4"></a><span class="co"># by setting the UPPER triangular part to 0, we get the LOWER triangular part and the diagonal</span></span>
<span id="cb21-5"><a href="code.html#cb21-5"></a>L[<span class="kw">upper.tri</span>(L)] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb21-6"><a href="code.html#cb21-6"></a></span>
<span id="cb21-7"><a href="code.html#cb21-7"></a>U &lt;-<span class="st"> </span>A</span>
<span id="cb21-8"><a href="code.html#cb21-8"></a><span class="co"># by setting the LOWER triangular part to 0, we get the UPPER triangular part and the diagonal</span></span>
<span id="cb21-9"><a href="code.html#cb21-9"></a>U[<span class="kw">lower.tri</span>(U)] &lt;-<span class="st"> </span><span class="dv">0</span></span></code></pre></div>
</div>
<div id="code-block-5.115.12" class="section level3 unnumbered" number="">
<h3>Code block 5.11/5.12</h3>
<p>Note that there is a <code>toeplitz()</code> function in <em>stats</em> (base R) and <code>Topelitz()</code> (note the first capital letter) in <em>pracma</em> library. Here, I use base R version.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="code.html#cb22-1"></a>t &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb22-2"><a href="code.html#cb22-2"></a>T &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">toeplitz</span>(t)</span>
<span id="cb22-3"><a href="code.html#cb22-3"></a>H &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">hankel</span>(t, <span class="dt">b=</span> <span class="kw">c</span>(t[<span class="op">-</span><span class="dv">1</span>], t[<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## Warning in pracma::hankel(t, b = c(t[-1], t[1])): a[n] not equal to b[1], b[1]
## set to a[n].</code></pre>
</div>
<div id="code-block-5.135.14" class="section level3 unnumbered" number="">
<h3>Code block 5.13/5.14</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="code.html#cb24-1"></a>l &lt;-<span class="st"> </span><span class="fl">0.01</span></span>
<span id="cb24-2"><a href="code.html#cb24-2"></a>I &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">4</span>)</span>
<span id="cb24-3"><a href="code.html#cb24-3"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb24-4"><a href="code.html#cb24-4"></a>As &lt;-<span class="st"> </span>A <span class="op">+</span><span class="st"> </span>l <span class="op">*</span><span class="st"> </span>I</span></code></pre></div>
</div>
<div id="code-block-5.155.16" class="section level3 unnumbered" number="">
<h3>Code block 5.15/5.16</h3>
<p>Base R does not implement trace function, as it is simply a <code>sum(diag(M))</code>. However, you can use <code>Trace()</code> from <em>pracma</em> library.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="code.html#cb25-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb25-2"><a href="code.html#cb25-2"></a>tr &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">Trace</span>(A)</span></code></pre></div>
</div>
</div>
<div id="chapter-6" class="section level2 unnumbered" number="">
<h2>Chapter 6</h2>
<div id="code-block-6.16.2" class="section level3 unnumbered" number="">
<h3>Code block 6.1/6.2</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="code.html#cb26-1"></a>M1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb26-2"><a href="code.html#cb26-2"></a>M2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">5</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb26-3"><a href="code.html#cb26-3"></a>C &lt;-<span class="st"> </span>M1 <span class="op">%*%</span><span class="st"> </span>M2</span></code></pre></div>
</div>
<div id="code-block-6.36.4" class="section level3 unnumbered" number="">
<h3>Code block 6.3/6.4</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="code.html#cb27-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">2</span><span class="op">*</span><span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb27-2"><a href="code.html#cb27-2"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">2</span><span class="op">*</span><span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb27-3"><a href="code.html#cb27-3"></a>C1 &lt;-<span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>B</span>
<span id="cb27-4"><a href="code.html#cb27-4"></a>C2 &lt;-<span class="st"> </span>B <span class="op">%*%</span><span class="st"> </span>A</span></code></pre></div>
</div>
<div id="code-block-6.56.6" class="section level3 unnumbered" number="">
<h3>Code block 6.5/6.6</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="code.html#cb28-1"></a>M1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb28-2"><a href="code.html#cb28-2"></a>M2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb28-3"><a href="code.html#cb28-3"></a>C &lt;-<span class="st"> </span>M1 <span class="op">*</span><span class="st"> </span>M2</span></code></pre></div>
</div>
<div id="code-block-6.76.8" class="section level3 unnumbered" number="">
<h3>Code block 6.7/6.8</h3>
<p>Note that by default, matrix is constructed by column. To match the code, we need to use <code>byrow=TRUE</code> option.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="code.html#cb29-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb29-2"><a href="code.html#cb29-2"></a><span class="kw">c</span>(A)</span></code></pre></div>
<pre><code>## [1] 1 4 2 5 3 6</code></pre>
</div>
<div id="code-block-6.96.10" class="section level3 unnumbered" number="">
<h3>Code block 6.9/6.10</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="code.html#cb31-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb31-2"><a href="code.html#cb31-2"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb31-3"><a href="code.html#cb31-3"></a>f &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">Trace</span>(<span class="kw">t</span>(A) <span class="op">%*%</span><span class="st"> </span>B)</span></code></pre></div>
</div>
<div id="code-block-6.116.12" class="section level3 unnumbered" number="">
<h3>Code block 6.11/6.12</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="code.html#cb32-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb32-2"><a href="code.html#cb32-2"></a><span class="kw">norm</span>(A, <span class="dt">type=</span><span class="st">&quot;F&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 2.097149</code></pre>
</div>
</div>
<div id="chapter-7" class="section level2 unnumbered" number="">
<h2>Chapter 7</h2>
<div id="code-block-7.17.2" class="section level3 unnumbered" number="">
<h3>Code block 7.1/7.2</h3>
<p>You can use <code>Rank()</code> from the <em>pracma</em> library. Alternatively, you can use <code>rankMatrix()</code> function from the <em>Matrix</em> library, which in addition to the rank itself, returns information on the method used to estimate the rank via attributes.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="code.html#cb34-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">6</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">6</span>)</span>
<span id="cb34-2"><a href="code.html#cb34-2"></a>r1 &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">Rank</span>(A)</span>
<span id="cb34-3"><a href="code.html#cb34-3"></a>r2 &lt;-<span class="st"> </span>Matrix<span class="op">::</span><span class="kw">rankMatrix</span>(A)</span></code></pre></div>
</div>
<div id="code-block-7.37.4" class="section level3 unnumbered" number="">
<h3>Code block 7.3/7.4</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="code.html#cb35-1"></a>s &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">1</span>)</span>
<span id="cb35-2"><a href="code.html#cb35-2"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">5</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb35-3"><a href="code.html#cb35-3"></a>r1 &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">Rank</span>(A)</span>
<span id="cb35-4"><a href="code.html#cb35-4"></a>r2 &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">Rank</span>(s <span class="op">*</span><span class="st"> </span>A)</span>
<span id="cb35-5"><a href="code.html#cb35-5"></a><span class="kw">print</span>(<span class="kw">c</span>(r1, r2))</span></code></pre></div>
<pre><code>## [1] 3 3</code></pre>
</div>
<div id="code-block-7.57.6" class="section level3 unnumbered" number="">
<h3>Code block 7.5/7.6</h3>
<p>Source code for <code>Rank()</code> function from <em>pracma</em> library.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="code.html#cb37-1"></a>pracma<span class="op">::</span>Rank</span></code></pre></div>
<pre><code>## function (M) 
## {
##     if (length(M) == 0) 
##         return(0)
##     if (!is.numeric(M)) 
##         stop(&quot;Argument &#39;M&#39; must be a numeric matrix.&quot;)
##     if (is.vector(M)) 
##         M &lt;- matrix(c(M), nrow = length(M), ncol = 1)
##     r1 &lt;- qr(M)$rank
##     sigma &lt;- svd(M)$d
##     tol &lt;- max(dim(M)) * max(sigma) * .Machine$double.eps
##     r2 &lt;- sum(sigma &gt; tol)
##     if (r1 != r2) 
##         warning(&quot;Rank calculation may be problematic.&quot;)
##     return(r2)
## }
## &lt;bytecode: 0x0000000015c3e448&gt;
## &lt;environment: namespace:pracma&gt;</code></pre>
<p>Source code for <code>rankMatrix()</code> function from <em>Matrix</em> library.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="code.html#cb39-1"></a>Matrix<span class="op">::</span>rankMatrix</span></code></pre></div>
<pre><code>## function (x, tol = NULL, method = c(&quot;tolNorm2&quot;, &quot;qr.R&quot;, &quot;qrLINPACK&quot;, 
##     &quot;qr&quot;, &quot;useGrad&quot;, &quot;maybeGrad&quot;), sval = svd(x, 0, 0)$d, warn.t = TRUE) 
## {
##     stopifnot(length(d &lt;- dim(x)) == 2)
##     p &lt;- min(d)
##     method &lt;- match.arg(method)
##     if (useGrad &lt;- (method %in% c(&quot;useGrad&quot;, &quot;maybeGrad&quot;))) {
##         stopifnot(length(sval) == p, diff(sval) &lt;= 0)
##         if (sval[1] == 0) {
##             useGrad &lt;- FALSE
##             method &lt;- eval(formals()[[&quot;method&quot;]])[[1]]
##         }
##         else {
##             ln.av &lt;- log(abs(sval))
##             diff1 &lt;- diff(ln.av)
##             if (method == &quot;maybeGrad&quot;) {
##                 grad &lt;- (min(ln.av) - max(ln.av))/p
##                 useGrad &lt;- !is.na(grad) &amp;&amp; min(diff1) &lt;= min(-3, 
##                   10 * grad)
##             }
##         }
##     }
##     if (!useGrad) {
##         x.dense &lt;- is.numeric(x) || is(x, &quot;denseMatrix&quot;)
##         if ((Meth &lt;- method) == &quot;qr&quot;) 
##             method &lt;- if (x.dense) 
##                 &quot;qrLINPACK&quot;
##             else &quot;qr.R&quot;
##         else Meth &lt;- substr(method, 1, 2)
##         if (Meth == &quot;qr&quot;) {
##             if (is.null(tol)) 
##                 tol &lt;- max(d) * .Machine$double.eps
##         }
##         else {
##             if (is.null(tol)) {
##                 if (!x.dense &amp;&amp; missing(sval) &amp;&amp; prod(d) &gt;= 100000L) 
##                   warning(gettextf(&quot;rankMatrix(&lt;large sparse Matrix&gt;, method = &#39;%s&#39;) coerces to dense matrix.\n Probably should rather use method = &#39;qr&#39; !?&quot;, 
##                     method), immediate. = TRUE, domain = NA)
##                 stopifnot(diff(sval) &lt;= 0)
##                 tol &lt;- max(d) * .Machine$double.eps
##             }
##             else stopifnot((tol &lt;- as.numeric(tol)[[1]]) &gt;= 0)
##         }
##     }
##     structure(if (useGrad) 
##         which.min(diff1)
##     else if (Meth == &quot;qr&quot;) {
##         if ((do.t &lt;- (d[1L] &lt; d[2L])) &amp;&amp; warn.t) 
##             warning(gettextf(&quot;rankMatrix(x, method=&#39;qr&#39;): computing t(x) as nrow(x) &lt; ncol(x)&quot;))
##         q.r &lt;- qr(if (do.t) 
##             t(x)
##         else x, tol = tol, LAPACK = method != &quot;qrLINPACK&quot;)
##         if (x.dense &amp;&amp; (method == &quot;qrLINPACK&quot;)) 
##             q.r$rank
##         else {
##             diagR &lt;- if (x.dense) 
##                 diag(q.r$qr)
##             else diag(q.r@R)
##             d.i &lt;- abs(diagR)
##             if ((mdi &lt;- max(d.i)) &gt; 0) 
##                 sum(d.i &gt;= tol * mdi)
##             else 0L
##         }
##     }
##     else if (sval[1] &gt; 0) 
##         sum(sval &gt;= tol * sval[1])
##     else 0L, method = method, useGrad = useGrad, tol = if (useGrad) 
##         NA
##     else tol)
## }
## &lt;bytecode: 0x00000000204f0388&gt;
## &lt;environment: namespace:Matrix&gt;</code></pre>
</div>
</div>
<div id="chapter-8" class="section level2 unnumbered" number="">
<h2>Chapter 8</h2>
<div id="code-block-8.18.2" class="section level3 unnumbered" number="">
<h3>Code block 8.1/8.2</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="code.html#cb41-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb41-2"><a href="code.html#cb41-2"></a>pracma<span class="op">::</span><span class="kw">nullspace</span>(A)</span></code></pre></div>
<pre><code>##             [,1]
## [1,] -0.55208467
## [2,]  0.67249530
## [3,]  0.48849457
## [4,]  0.06576957</code></pre>
</div>
</div>
<div id="chapter-9" class="section level2 unnumbered" number="">
<h2>Chapter 9</h2>
<div id="code-block-9.19.2" class="section level3 unnumbered" number="">
<h3>Code block 9.1/9.2</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="code.html#cb43-1"></a>z &lt;-<span class="st"> </span><span class="kw">complex</span>(<span class="dt">real=</span><span class="dv">3</span>, <span class="dt">imaginary=</span><span class="dv">4</span>)</span>
<span id="cb43-2"><a href="code.html#cb43-2"></a>Z &lt;-<span class="st"> </span><span class="kw">complex</span>(<span class="dt">length.out=</span><span class="dv">2</span>, <span class="dt">real=</span><span class="dv">0</span>, <span class="dt">imaginary=</span><span class="dv">0</span>)</span>
<span id="cb43-3"><a href="code.html#cb43-3"></a>Z[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span>4i</span></code></pre></div>
</div>
<div id="code-block-9.39.4" class="section level3 unnumbered" number="">
<h3>Code block 9.3/9.4</h3>
<p>Base R does not have a function that generates random integers on the interval. I will use <code>sample()</code> with replacement from the range of integers to replicate this. Also note that I have renamed <code>i</code> to <code>im</code> to minimize the confusion.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="code.html#cb44-1"></a>r &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="op">-</span><span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">size=</span><span class="dv">3</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb44-2"><a href="code.html#cb44-2"></a>im &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="op">-</span><span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">size=</span><span class="dv">3</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb44-3"><a href="code.html#cb44-3"></a>Z &lt;-<span class="st"> </span>r <span class="op">+</span><span class="st"> </span>im <span class="op">*</span><span class="st"> </span>1i</span>
<span id="cb44-4"><a href="code.html#cb44-4"></a><span class="kw">print</span>(Z)</span></code></pre></div>
<pre><code>## [1] -3-3i  1+4i  3+3i</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="code.html#cb46-1"></a><span class="kw">print</span>(<span class="kw">Conj</span>(Z))</span></code></pre></div>
<pre><code>## [1] -3+3i  1-4i  3-3i</code></pre>
</div>
<div id="code-block-9.59.6" class="section level3 unnumbered" number="">
<h3>Code block 9.5/9.6</h3>
<p><code>pracma::dot()</code> implements the Hermitian dot product.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="code.html#cb48-1"></a>v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, 1i)</span>
<span id="cb48-2"><a href="code.html#cb48-2"></a>pracma<span class="op">::</span><span class="kw">dot</span>(v, v)</span></code></pre></div>
<pre><code>## [1] 1+0i</code></pre>
</div>
</div>
<div id="chapter-10" class="section level2 unnumbered" number="">
<h2>Chapter 10</h2>
<div id="code-block-10.110.2" class="section level3 unnumbered" number="">
<h3>Code block 10.1/10.2</h3>
<p>You can use <code>pracma::lu()</code> function but note that it works only on <em>square</em>, positive definite matrices.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="code.html#cb50-1"></a><span class="co"># Using the square matrix from practice problem b</span></span>
<span id="cb50-2"><a href="code.html#cb50-2"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb50-3"><a href="code.html#cb50-3"></a>pracma<span class="op">::</span><span class="kw">lu</span>(A)</span></code></pre></div>
<pre><code>## $L
##      [,1] [,2] [,3]
## [1,]  1.0    0    0
## [2,]  0.5    1    0
## [3,]  1.5    1    1
## 
## $U
##      [,1] [,2] [,3]
## [1,]    2    0  1.0
## [2,]    0    1  1.5
## [3,]    0    0  0.0</code></pre>
</div>
<div id="code-block-10.310.4" class="section level3 unnumbered" number="">
<h3>Code block 10.3/10.4</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="code.html#cb52-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">2</span><span class="op">*</span><span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb52-2"><a href="code.html#cb52-2"></a>pracma<span class="op">::</span><span class="kw">rref</span>(A)</span></code></pre></div>
<pre><code>##      [,1] [,2]      [,3]      [,4]
## [1,]    1    0  2.157181  1.754766
## [2,]    0    1 -1.707549 -2.123415</code></pre>
</div>
</div>
<div id="chapter-11" class="section level2 unnumbered" number="">
<h2>Chapter 11</h2>
<div id="code-block-11.111.2" class="section level3 unnumbered" number="">
<h3>Code block 11.1/11.2</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="code.html#cb54-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb54-2"><a href="code.html#cb54-2"></a><span class="kw">det</span>(A)</span></code></pre></div>
<pre><code>## [1] 0.2765355</code></pre>
</div>
</div>
<div id="chapter-12" class="section level2 unnumbered" number="">
<h2>Chapter 12</h2>
<div id="code-block-12.112.2" class="section level3 unnumbered" number="">
<h3>Code block 12.1/12.2</h3>
<p>In R, you find the inverse via <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/solve.html">solve()</a>. The latter solves an equation <span class="math inline">\(Ax = b\)</span>, omitting the second argument defaults <code>b = I</code> and the equation is solved to find the inverse. I have added <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Round.html">round()</a> to make it easier to see that <span class="math inline">\(A A^-1\)</span> produces an identity matrix.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="code.html#cb56-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb56-2"><a href="code.html#cb56-2"></a>Ai &lt;-<span class="st"> </span><span class="kw">solve</span>(A)</span>
<span id="cb56-3"><a href="code.html#cb56-3"></a><span class="kw">round</span>(A <span class="op">%*%</span><span class="st"> </span>Ai, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
</div>
<div id="code-block-12.312.4" class="section level3 unnumbered" number="">
<h3>Code block 12.3/12.4</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="code.html#cb58-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb58-2"><a href="code.html#cb58-2"></a>Acat &lt;-<span class="st"> </span><span class="kw">cbind</span>(A, <span class="kw">diag</span>(<span class="dv">1</span>, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">3</span>))</span>
<span id="cb58-3"><a href="code.html#cb58-3"></a>Ar &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">rref</span>(Acat) <span class="co"># RREF</span></span>
<span id="cb58-4"><a href="code.html#cb58-4"></a>Ar &lt;-<span class="st"> </span>Ar[, <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>] <span class="co"># keep inverse</span></span>
<span id="cb58-5"><a href="code.html#cb58-5"></a>Ai &lt;-<span class="st"> </span><span class="kw">solve</span>(A)</span>
<span id="cb58-6"><a href="code.html#cb58-6"></a><span class="kw">round</span>(Ar <span class="op">-</span><span class="st"> </span>Ai, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    0    0    0
## [2,]    0    0    0
## [3,]    0    0    0</code></pre>
</div>
<div id="code-block-12.512.6" class="section level3 unnumbered" number="">
<h3>Code block 12.5/12.6</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="code.html#cb60-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">5</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb60-2"><a href="code.html#cb60-2"></a>Al &lt;-<span class="st"> </span><span class="kw">solve</span>(<span class="kw">t</span>(A) <span class="op">%*%</span><span class="st"> </span>A) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(A)</span>
<span id="cb60-3"><a href="code.html#cb60-3"></a><span class="kw">round</span>(Al <span class="op">%*%</span><span class="st"> </span>A, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
</div>
<div id="code-block-12.712.8" class="section level3 unnumbered" number="">
<h3>Code block 12.7/12.8</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="code.html#cb62-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">3</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb62-2"><a href="code.html#cb62-2"></a>A[<span class="dv">2</span>, ] &lt;-<span class="st"> </span>A[<span class="dv">1</span>, ]</span>
<span id="cb62-3"><a href="code.html#cb62-3"></a>Api &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">pinv</span>(A)</span>
<span id="cb62-4"><a href="code.html#cb62-4"></a>Api <span class="op">%*%</span><span class="st"> </span>A</span></code></pre></div>
<pre><code>##             [,1]        [,2]       [,3]
## [1,]  0.62174449 -0.48151760 0.05761148
## [2,] -0.48151760  0.38703022 0.07333917
## [3,]  0.05761148  0.07333917 0.99122529</code></pre>
</div>
</div>
<div id="chapter-13" class="section level2 unnumbered" number="">
<h2>Chapter 13</h2>
<div id="code-block-13.113.2" class="section level3 unnumbered" number="">
<h3>Code block 13.1/13.2</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="code.html#cb64-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb64-2"><a href="code.html#cb64-2"></a>b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">5.5</span>, <span class="fl">-3.5</span>, <span class="fl">1.5</span>), <span class="dt">nrow=</span><span class="dv">3</span>)</span>
<span id="cb64-3"><a href="code.html#cb64-3"></a><span class="kw">lsfit</span>(A, b)<span class="op">$</span>coefficients</span></code></pre></div>
<pre><code>## Intercept        X1        X2 
##       0.0      -2.5       4.0</code></pre>
</div>
<div id="code-block-13.313.4" class="section level3 unnumbered" number="">
<h3>Code block 13.3/13.4</h3>
<p>In R, you first perform QT decomposition via <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/qr.html">qr()</a> and get an object. Then, you can extract component matrices of the decomposition via <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/qraux.html">qr.Q()</a> and <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/qraux.html">qr.R()</a>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="code.html#cb66-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb66-2"><a href="code.html#cb66-2"></a>QR &lt;-<span class="st"> </span><span class="kw">qr</span>(A)</span>
<span id="cb66-3"><a href="code.html#cb66-3"></a>Q &lt;-<span class="st"> </span><span class="kw">qr.Q</span>(QR)</span>
<span id="cb66-4"><a href="code.html#cb66-4"></a>R &lt;-<span class="st"> </span><span class="kw">qr.R</span>(QR)</span></code></pre></div>
</div>
</div>
<div id="chapter-15" class="section level2 unnumbered" number="">
<h2>Chapter 15</h2>
<div id="code-block-15.115.2" class="section level3 unnumbered" number="">
<h3>Code block 15.1/15.2</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="code.html#cb67-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb67-2"><a href="code.html#cb67-2"></a>eigenA &lt;-<span class="st"> </span><span class="kw">eigen</span>(A)</span>
<span id="cb67-3"><a href="code.html#cb67-3"></a>V &lt;-<span class="st"> </span>eigenA<span class="op">$</span>vectors</span>
<span id="cb67-4"><a href="code.html#cb67-4"></a>L &lt;-<span class="st"> </span>eigenA<span class="op">$</span>values</span></code></pre></div>
</div>
<div id="code-block-15.315.4" class="section level3 unnumbered" number="">
<h3>Code block 15.3/15.4</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="code.html#cb68-1"></a>n &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb68-2"><a href="code.html#cb68-2"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span>n<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span>n, <span class="dt">ncol=</span>n)</span>
<span id="cb68-3"><a href="code.html#cb68-3"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span>n<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span>n, <span class="dt">ncol=</span>n)</span>
<span id="cb68-4"><a href="code.html#cb68-4"></a>eigenAB &lt;-<span class="st"> </span>geigen<span class="op">::</span><span class="kw">geigen</span>(A, B)</span>
<span id="cb68-5"><a href="code.html#cb68-5"></a>evecs &lt;-<span class="st"> </span>eigenAB<span class="op">$</span>vectors</span>
<span id="cb68-6"><a href="code.html#cb68-6"></a>evals &lt;-<span class="st"> </span>eigenAB<span class="op">$</span>vals</span></code></pre></div>
</div>
</div>
<div id="chapter-16" class="section level2 unnumbered" number="">
<h2>Chapter 16</h2>
<div id="code-block-16.116.2" class="section level3 unnumbered" number="">
<h3>Code block 16.1/16.2</h3>
<p>Note that by default number of left (matrix <strong>U</strong>) and right (matrix <strong>V</strong>) singular vectors is determined as, respectively, <code>nu = min(n, p)</code> and <code>nv = min(n, p)</code> for the <em>n × p</em> matrix. Therefore, I included <code>nv=ncol(A)</code> to replicate output by Python. Also note that R, like Matlab, return <strong>V</strong>. Also note that singular values attribute is <code>d</code> and it is a vector not a diagonal matrix.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="code.html#cb69-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb69-2"><a href="code.html#cb69-2"></a>svdA &lt;-<span class="st"> </span><span class="kw">svd</span>(A, <span class="dt">nv=</span><span class="kw">ncol</span>(A))</span>
<span id="cb69-3"><a href="code.html#cb69-3"></a>U &lt;-<span class="st"> </span>svdA<span class="op">$</span>u</span>
<span id="cb69-4"><a href="code.html#cb69-4"></a>s &lt;-<span class="st"> </span>svdA<span class="op">$</span>d</span>
<span id="cb69-5"><a href="code.html#cb69-5"></a>V &lt;-<span class="st"> </span>svdA<span class="op">$</span>v</span></code></pre></div>
</div>
<div id="code-block-16.316.4" class="section level3 unnumbered" number="">
<h3>Code block 16.3/16.4</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="code.html#cb70-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">5</span><span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb70-2"><a href="code.html#cb70-2"></a>s &lt;-<span class="st"> </span><span class="kw">svd</span>(A)<span class="op">$</span>d</span>
<span id="cb70-3"><a href="code.html#cb70-3"></a>condnum &lt;-<span class="st"> </span><span class="kw">max</span>(s) <span class="op">/</span><span class="st"> </span><span class="kw">min</span>(s)</span>
<span id="cb70-4"><a href="code.html#cb70-4"></a></span>
<span id="cb70-5"><a href="code.html#cb70-5"></a><span class="co">#compare above with pracma::cond() </span></span>
<span id="cb70-6"><a href="code.html#cb70-6"></a><span class="kw">print</span>(<span class="kw">c</span>(condnum, pracma<span class="op">::</span><span class="kw">cond</span>(A)))</span></code></pre></div>
<pre><code>## [1] 13.12641 13.12641</code></pre>
</div>
</div>
<div id="chapter-17" class="section level2 unnumbered" number="">
<h2>Chapter 17</h2>
<div id="code-block-17.117.2" class="section level3 unnumbered" number="">
<h3>Code block 17.1/17.2</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="code.html#cb72-1"></a>m &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb72-2"><a href="code.html#cb72-2"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span>m<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow=</span>m, <span class="dt">ncol=</span>m)</span>
<span id="cb72-3"><a href="code.html#cb72-3"></a>v &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span>m), <span class="dt">nrow=</span><span class="dv">1</span>, <span class="dt">ncol=</span>m)</span>
<span id="cb72-4"><a href="code.html#cb72-4"></a>v <span class="op">%*%</span><span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(v)</span></code></pre></div>
<pre><code>##           [,1]
## [1,] -2.010692</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="solutions-for-code-challenges.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cohen-linear-algebra.pdf", "cohen-linear-algebra.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
